woc_hun_first_branch = {
	slot = 1
	generic = no
	ai = yes
	potential_on_load = {
		has_dlc = "Winds of Change"
	}
	potential = {
		has_dlc = "Winds of Change"
		tag = HUN
		NOT = { map_setup = map_setup_random }
	}
	has_country_shield = yes
	
	hun_old_alliances = {
		icon = mission_pol_protect_hungary
		required_missions = { }
		position = 1
		
		provinces_to_highlight = {
			OR = {
				owned_by = POL
				AND = {
					NOT = { exists = POL }
					region = poland_region
					ROOT = {
						NOT = {
							num_of_owned_provinces_with = {
								value = 6
								region = poland_region
							}
						}
					}
				}
			}
		}
		
		trigger = {
			if = {
				limit = {
					exists = POL
					has_dlc = "Res Publica"
					POL = {
						OR = { 
							has_reform = polish_elective_monarchy
							has_reform = elective_monarchy
						}
					}
				}
				OR = { 
					POL = { dynasty = root }
					AND = {
						alliance_with = POL
						POL = {
							has_opinion = {
								who = ROOT
								value = 190
							}
						}
					}
					overlord_of = POL
					AND = { 
						OR = {
							is_rival = POL
							POL = { is_rival = ROOT }
						}
						army_size = POL
					}
				}
			}
			else_if = {
				limit = { exists = POL }
				OR = {
					AND = {
						alliance_with = POL
						POL = {
							has_opinion = {
								who = ROOT
								value = 190
							}
						}
					}
					overlord_of = POL
					AND = { 
						OR = {
							is_rival = POL
							POL = { is_rival = ROOT }
						}
						army_size = POL
					}
				}
			}
			else_if = {
				limit = {
					NOT = { exists = POL }
				}
				OR = {
					army_size_percentage = 1
					num_of_owned_provinces_with = {
						value = 6
						region = poland_region
					}
				}
			}
			is_subject = no
		}
		
		effect = {
			wallachia_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			moldavia_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			if = {
				limit = {
					alliance_with = POL
				}
				custom_tooltip = hun_alliance_poland_tt_yes
				tooltip = {
					add_historical_friend = POL
					add_country_modifier = {
						name = "hun_polish_alliance"
						duration = 7300
					}
				}
			}
			else = {
				custom_tooltip = hun_alliance_poland_tt_no
				tooltip = {
					add_historical_friend = POL
					add_country_modifier = {
						name = "hun_polish_alliance"
						duration = 7300
					}
				}
			}
			hidden_effect = {
				if = {
					limit = {
						alliance_with = POL
					}
					add_historical_friend = POL
					POL = {
						add_historical_friend = HUN
					}
					add_country_modifier = {
						name = "hun_polish_alliance"
						duration = 7300
					}
				}
			}
		}
		ai_weight = {
			factor = 500	#Mission itself is rather ignorable, but the next one should be important for AI Hungary
		}
	}
	
	hun_deal_with_the_impaler = {
		icon = mission_impaled_soldies
		required_missions = { hun_old_alliances }
		position = 3
		
		provinces_to_highlight = {
			area = wallachia_area
			NOT = {
				country_or_non_sovereign_subject_holds = ROOT
			}
		}
		
		trigger = {
			wallachia_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
		}
		
		effect = {
			wallachia_area = {
				add_province_modifier = {
					name = hun_wallachian_military_frontier
					duration = 7300
				}
			}
			croatia_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT	}
					NOT = { is_core = ROOT	}
				}
				add_permanent_claim = ROOT
			}
			if = {
				limit = {
					exists = SER
					SER = {
						is_free_or_tributary_trigger = yes
					}
				}
				custom_tooltip = hun_serbia_cb_tt_yes
				tooltip = {
					add_casus_belli = {
						type = cb_vassalize_mission
						months = 300
						target = SER
					}
				}
			}
			else = {
				custom_tooltip = hun_serbia_cb_tt_no
				tooltip = {
					add_casus_belli = {
						type = cb_vassalize_mission
						months = 300
						target = SER
					}
				}
			}
			if = {
				limit = {
					NOT = {
						exists = SER
					}
				}
				custom_tooltip = hun_cb_tt_else_yes
				tooltip = {
					serbia_area = {
						limit = {
							NOT = { is_permanent_claim = ROOT	}
							NOT = { is_core = ROOT	}
						}
						add_permanent_claim = ROOT
					}
					rascia_area = {
						limit = {
							NOT = { is_permanent_claim = ROOT	}
							NOT = { is_core = ROOT	}
						}
						add_permanent_claim = ROOT
					}
				}
			}
			else = {
				custom_tooltip = hun_cb_tt_else_no
				tooltip = {
					serbia_area = {
						limit = {
							NOT = { is_permanent_claim = ROOT	}
							NOT = { is_core = ROOT	}
						}
						add_permanent_claim = ROOT
					}
					rascia_area = {
						limit = {
							NOT = { is_permanent_claim = ROOT	}
							NOT = { is_core = ROOT	}
						}
						add_permanent_claim = ROOT
					}
				}
			}
			if = {
				limit = {
					exists = BOS
					BOS = {
						is_free_or_tributary_trigger = yes
					}
				}
				custom_tooltip = hun_bosnia_cb_tt_yes
				tooltip = {
					add_casus_belli = {
						type = cb_vassalize_mission
						months = 300
						target = BOS
					}
				}
			}
			else = {
				custom_tooltip = hun_bosnia_cb_tt_no
				tooltip = {
					add_casus_belli = {
						type = cb_vassalize_mission
						months = 300
						target = BOS
					}
				}
			}
			if = {
				limit = {
					NOT = {
						exists = BOS
					}
				}
				custom_tooltip = hun_cb_tt_else_yes
				tooltip = {
					bosnia_area = {
						limit = {
							NOT = { is_core = ROOT }
							NOT = { is_permanent_claim = ROOT }
						}
						add_permanent_claim = ROOT
					}
				}
			}
			else = {
				custom_tooltip = hun_cb_tt_else_no
				tooltip = {
					bosnia_area = {
						limit = {
							NOT = { is_core = ROOT }
							NOT = { is_permanent_claim = ROOT }
						}
						add_permanent_claim = ROOT
					}
				}
			}
			hidden_effect = {
				if = {
					limit = {
						exists = BOS
						BOS = {
							is_free_or_tributary_trigger = yes
						}
					}
					add_casus_belli = {
						type = cb_vassalize_mission
						months = 300
						target = BOS
					}
				}
				else = {
					bosnia_area = {
						limit = {
							NOT = { is_core = ROOT }
							NOT = { is_permanent_claim = ROOT }
						}
						add_permanent_claim = ROOT
					}
				}
				if = {
					limit = {
						exists = SER
						SER = {
							is_free_or_tributary_trigger = yes
						}
					}
					add_casus_belli = {
						type = cb_vassalize_mission
						months = 300
						target = SER
					}
				}
				else = {
					serbia_area = {
						limit = {
							NOT = { is_core = ROOT }
							NOT = { is_permanent_claim = ROOT }
						}
						add_permanent_claim = ROOT
					}
					rascia_area = {
						limit = {
							NOT = { is_core = ROOT }
							NOT = { is_permanent_claim = ROOT }
						}
						add_permanent_claim = ROOT
					}
				}
			}
		}
		ai_weight = {
			factor = 500
		}
	}
	
	hun_the_despotate_of_serbia = {
		icon = defeat_the_serbs
		required_missions = { hun_deal_with_the_impaler }
		position = 5
		
		provinces_to_highlight = {
			OR = {
				area = serbia_area
				area = rascia_area
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		
		trigger = {
			num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
				OR = {
					area = serbia_area
					area = rascia_area
				}
				value = 6
			}
		}
		
		effect = {
			add_dip_power = 100
			add_country_modifier = {
				name = "hun_securing_the_balkans"
				duration = 7300
			}
			if = {
				limit = {
					calc_true_if = {
						all_subject_country = {
							capital_scope = {
								region = balkan_region
							}
						}
						amount = 2
					}
				}
				custom_tooltip = hun_balkan_subjects_tt_yes
			}
			else = {
				custom_tooltip = hun_balkan_subjects_tt_no
			}
			hidden_effect = {
				if = {
					limit = {
						calc_true_if = {
							all_subject_country = {
								capital_scope = {
									region = balkan_region
								}
							}
							amount = 2
						}
					}
					set_country_flag = hun_upgrade_strong_duchies
				}
			}
		}
		ai_weight = {
			factor = 500
		}
	}
	
	hun_fekete_sereg = {
		icon = mission_fekete_sereg
		required_missions = { hun_the_anatolian_threat }
		position = 7
		
		provinces_to_highlight = {
			is_capital = yes
			owner = {
				is_neighbor_of = root
				land_morale = root
				NOT = { is_subject_of = root }
			}
			NOT = { owned_by = root }
		}
		
		trigger = {
			OR = {
				custom_trigger_tooltip = {
					has_idea = found_the_black_army
					tooltip = hun_has_unlocked_third_ni
				}
				has_country_modifier = hun_black_army
				has_reform = black_army_reform
				custom_trigger_tooltip = {
					tooltip = emp_hun_black_army_supreme_trigger_tooltip
					OR = {
						current_age = age_of_absolutism
						current_age = age_of_revolutions
					}
				}
			}
			army_size_percentage = 1
			land_morale = 4
			all_neighbor_country = {
				OR = {
					NOT = { land_morale = root }
					is_subject_of = root
				}
			}
		}
		
		effect = {
			add_army_tradition_or_mil_power = { amount = 20 }
			add_country_modifier = {
				name = hun_supreme_black_army
				duration = 7300
			}
		}
	}
	
	hun_the_black_legion = {
		icon = gory_to_the_black_army
		required_missions = { hun_fekete_sereg }
		position = 7
		
		trigger = {
			OR = {
				custom_trigger_tooltip = {
					has_idea = found_the_black_army
					tooltip = hun_has_unlocked_third_ni
				}
				has_country_modifier = hun_black_army
				has_reform = black_army_reform
				custom_trigger_tooltip = {
					tooltip = emp_hun_black_army_supreme_trigger_tooltip
					OR = {
						current_age = age_of_absolutism
						current_age = age_of_revolutions
					}
				}
			}
			if = {
				limit = {
					has_dlc = "Cradle of Civilization"
				}
				army_professionalism = 0.5
			}
			else = {
				army_tradition = 75
			}
			num_of_mercenaries = 40
			has_mil_advisor_3 = yes
		}
		
		
		effect = {
			set_country_flag = hun_no_prof_black_army
			if = {
				limit = {
					has_dlc = "Cradle of Civilization"
				}
				custom_tooltip = hun_black_legion_tt
			}
			else = {
				add_mil_power = 100
			}
			add_country_modifier = {
				name = hun_black_legion
				duration = -1
			}
		}
	}
	
	hun_integrate_croatia = {
		icon = mission_integrate_croatia
		required_missions = { }
		position = 8
		
		trigger = {
			if = {
				limit = {
					CRO = {
						is_subject_of = ROOT
					}
				}
				CRO = {
					has_opinion = {
						who = ROOT
						value = 200
					}
				}
				if = {
					limit = {
						has_dlc = "The Cossacks"
					}
					OR = {
						CRO = {
							trust = { who = ROOT value = 90 }
						}
						advisor = statesman
					}
				}
			}
			else = {
				owns = 152
				owns = 4756 
				owns = 1767
				owns = 131
				owns = 4752
				owns = 1826
			}
		}
		
		provinces_to_highlight = {
			if = {
				limit = {
					exists = CRO
					CRO = {
						is_subject_of = ROOT
					}
				}
				owned_by = CRO
			}
			else = {
				OR = {
					province_id = 152
					province_id = 4756
					province_id = 1767
					province_id = 131
					province_id = 4752
					province_id = 1826
				}
				NOT = {
					owned_by = ROOT
				}
			}
		}
		
		effect = {
			custom_tooltip = hun_integrate_croatia_random_dev
			add_country_modifier = {
				name = hun_tighten_croatian_union
				duration = 7300
			}
			130 = {
				if = {
					limit = {
						NOT = { is_permanent_claim = ROOT    }
						NOT = { is_core = ROOT    }
					}
					add_permanent_claim = ROOT
				}
			}
			east_adriatic_coast_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT	}
					NOT = { is_core = ROOT	}
				}
				add_permanent_claim = ROOT
			}
			if = {
				limit = {
					has_country_modifier = annexers_legacy
				}
				custom_tooltip = hun_annexed_subject_tt_yes
			}
			else = {
				custom_tooltip = hun_annexed_subject_tt_no
			}
			hidden_effect = {
				if = {
					limit = {
						has_country_modifier = annexers_legacy
					}
					remove_country_modifier = annexers_legacy
				}
				for = {
					amount = 5
					effect = "
						random_province = {
							limit = {
								country_or_non_sovereign_subject_holds = ROOT
								culture = croatian
							}
							add_random_development = 1
						}
					"
				}
			}
		}
		ai_weight = {
			factor = 500
		}
	}
	
	hun_recover_dalmatia = {
		icon = dalmatian_conquest
		required_missions = { hun_integrate_croatia }
		position = 8
		
		trigger = {
			east_adriatic_coast_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
		}
		
		provinces_to_highlight = {
			area = east_adriatic_coast_area
			NOT = {
				country_or_non_sovereign_subject_holds = ROOT
			}
		}
		
		effect = {
			east_adriatic_coast_area = {
				add_base_production = 1
			}
			random_province = {
				limit = {
					has_port = yes
					country_or_non_sovereign_subject_holds = ROOT
				}
				add_unit_construction = {
					type = light_ship
					amount = 5
					speed = 0.25
					cost = 0
				}
			}
			custom_tooltip = hun_empty
			venetia_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			naples_area = {
				limit = {
					NOT = { is_claim = root }
					NOT = { is_core = root }
				}
				add_permanent_claim = ROOT
			}
			apulia_area = {
				limit = {
					NOT = { is_claim = root }
					NOT = { is_core = root }
				}
				add_permanent_claim = ROOT
			}
			calabria_area = {
				limit = {
					NOT = { is_claim = root }
					NOT = { is_core = root }
				}
				add_permanent_claim = ROOT
			}
			if = {
				limit = {
					exists = NAP
					valid_for_personal_unions_trigger = yes
					NAP = {
						valid_for_personal_unions_trigger = yes
					}
				}
				custom_tooltip = hun_naples_cb_tt_yes
				tooltip = {
					add_casus_belli = {
						type = cb_restore_personal_union
						months = 300
						target = NAP
					}
				}
			}
			else = {
				custom_tooltip = hun_naples_cb_tt_no
				tooltip = {
					add_casus_belli = {
						type = cb_restore_personal_union
						months = 300
						target = NAP
					}
				}
			}
			hidden_effect = {
				if = {
					limit = {
						exists = NAP
						valid_for_personal_unions_trigger = yes
						NAP = {
							valid_for_personal_unions_trigger = yes
						}
					}
					add_casus_belli = {
						type = cb_restore_personal_union
						months = 300
						target = NAP
					}
				}
			}
		}
		ai_weight = {
			factor = 500
		}
	}
	
	hun_legacy_of_louis_the_great = {
		icon = king_of_naples
		required_missions = { hun_recover_dalmatia }
		position = 8
		
		trigger = {
			apulia_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			calabria_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			naples_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
		}
		
		provinces_to_highlight = {
			OR = {
				area = apulia_area
				area = calabria_area
				area = naples_area
			}
			NOT = {
				country_or_non_sovereign_subject_holds = ROOT
			}
		}
		
		effect = {
			add_country_modifier = {
				name = "hun_legacy_of_angevins"
				duration = 9125
			}
			if = {
				limit = {
					senior_union_with = NAP
				}
				if = {
					limit = {
						has_dlc = "Mandate of Heaven"
					}
					custom_tooltip = hun_naples_bonus_moh_yes
				}
				else = {
					custom_tooltip = hun_naples_bonus_yes
				}
			}
			else = {
				if = {
					limit = {
						has_dlc = "Mandate of Heaven"
					}
					custom_tooltip = hun_naples_bonus_moh_no
				}
				else = {
					custom_tooltip = hun_naples_bonus_no
				}
			}
			hidden_effect = {
				if = {
					limit = {
						senior_union_with = NAP
					}
					set_country_flag = no_integrate_penalty
					set_country_flag = hun_integrate_pu_bonus
				}
			}
		}
	}
}

woc_hun_second_branch = {
	slot = 2
	generic = no
	ai = yes
	potential_on_load = {
		has_dlc = "Winds of Change"
	}
	potential = {
		has_dlc = "Winds of Change"
		tag = HUN
		NOT = { map_setup = map_setup_random }
	}
	has_country_shield = yes
	
	hun_control_moldavia_new = {
		icon = mission_control_moldavia
		required_missions = { hun_old_alliances }
		position = 2
		
		provinces_to_highlight = {
			area = moldavia_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		
		trigger = {
			OR = {
				AND = {
					alliance_with = MOL
					marriage_with = MOL
				}
				moldavia_area = {
					type = all
					country_or_non_sovereign_subject_holds = ROOT
				}
				custom_trigger_tooltip = {
					tooltip = hun_mol_romans_invasion_tt
					MOL = {
						is_subject_of = ROOT
					}
				}
			}
		}
		
		effect = {
			malopolska_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			red_ruthenia_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			sandomierz_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			if = {
				limit = {
					alliance_with = MOL
					marriage_with = MOL
				}
				custom_tooltip = hun_alliance_moldavia_tt_yes
			}
			else = {
				custom_tooltip = hun_alliance_moldavia_tt_no
			}
			if = {
				limit = {
					moldavia_area = {
						type = all
						country_or_non_sovereign_subject_holds = ROOT
					}
				}
				custom_tooltip = hun_conquest_moldavia_tt_yes
				tooltip = {
					moldavia_area = {
						add_base_manpower = 1
					}
					moldavia_area = {
						add_nationalism = -20
					}
				}
			}
			else = {
				custom_tooltip = hun_conquest_moldavia_tt_no
				tooltip = {
					moldavia_area = {
						add_base_manpower = 1
					}
					moldavia_area = {
						add_nationalism = -20
					}
				}
			}
			hidden_effect = {
				if = {
					limit = {
						alliance_with = MOL
						marriage_with = MOL
					}
					set_global_flag = hun_moldavia_hungarian_alliance
				}
				else_if = {
					limit = {
						moldavia_area = {
							type = all
							country_or_non_sovereign_subject_holds = ROOT
						}
					}
					moldavia_area = {
						add_nationalism = -20
					}
					moldavia_area = {
						add_base_manpower = 1
					}
				}
			}
		}
		ai_weight = {
			factor = 500
		}
	}
	
	hun_bosnian_subjugation = {
		icon = fight_bosnian_heresies
		required_missions = { hun_deal_with_the_impaler }
		position = 4
		
		provinces_to_highlight = {
			area = bosnia_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		
		trigger = {
		    bosnia_area = {
			    type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
		}
		
		effect = {
			if = {
				limit = {
					BOS = {
						is_subject_of = ROOT
					}
				}
				custom_tooltip = hun_bosnian_subject_tt_yes
				tooltip = {
					if = {
						limit = {
							has_dlc = "The Cossacks"
						}
						add_trust = {
							who = BOS
							value = 10
							mutual = yes
						}
					}
					BOS = {
						add_liberty_desire = -10
					}
				}
			}
			else = {
				custom_tooltip = hun_bosnian_subject_tt_no
				tooltip = {
					if = {
						limit = {
							has_dlc = "The Cossacks"
						}
						add_trust = {
							who = BOS
							value = 10
							mutual = yes
						}
					}
					BOS = {
						add_liberty_desire = -10
					}
				}
			}
			if = {
				limit = {
					NOT = {
						BOS = {
							is_subject_of = ROOT
						}
					}
					bosnia_area = {
						type = all
						country_or_non_sovereign_subject_holds = ROOT
					}
				}
				custom_tooltip = hun_bosnian_conquest_tt_yes
				tooltip = {
					add_adm_power = 100
					bosnia_area = {
						add_local_autonomy = -50
					}
				}
			}
			else = {
				custom_tooltip = hun_bosnian_conquest_tt_no
				tooltip = {
					add_adm_power = 100
					bosnia_area = {
						add_local_autonomy = -50
					}
				}
			}
			hidden_effect = {
				if = {
					limit = {
						BOS = {
							is_subject_of = ROOT
						}
					}
					if = {
						limit = {
							has_dlc = "The Cossacks"
						}
						add_trust = {
							who = BOS
							value = 10
							mutual = yes
						}
					}
					BOS = {
						add_liberty_desire = -10
					}
				}
				else = {
					add_adm_power = 100
					bosnia_area = {
						add_local_autonomy = -50
					}
				}
			}
		}
		
		ai_weight = {
			factor = 500
		}
	}
	
	hun_heirs_of_ruthenia = {
		icon = mission_rule_ruthenia
		required_missions = { hun_jagiellonian_union }
		position = 5
		
		trigger = {
			num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
				value = 15
				OR = {
					area = yedisan_area
					area = zaporizhia_area
					region = ruthenia_region
				}
			}
			any_owned_province = {
				has_terrain = steppe
			}
		}
		
		provinces_to_highlight = {
			OR = {
				area = zaporizhia_area
				area = yedisan_area
				region = ruthenia_region
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		
		effect = {
			if = {
				limit = {
					has_dlc = "The Cossacks"
				}
				add_country_modifier = {
					name = hun_integrate_the_cossacks
					duration = 9125
				}
				set_country_flag = hun_upgrade_cossack_priv
				custom_tooltip = hun_upgrade_cossack_priv_tt
			}
			else = {
				add_mil_power = 100
				add_country_modifier = {
					name = hun_integrate_the_cossacks
					duration = 9125
				}
			}
			crimea_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
		}
	}
	
	hun_the_anatolian_threat = {
		icon = mission_ottoman_diplomacy
		required_missions = { }
		position = 6
		
		trigger = {
			if = {
				limit = {
					TUR = {
						any_owned_province = {
							region = balkan_region
						}
					}
				}
				calc_true_if = {
					desc = hun_ottoman_borders.tooltip
					amount = 3
					all_owned_province = {
						fort_level = 1
						any_neighbor_province = {
							owned_by = TUR
						}
					}
				}
			}
			else = {
				any_owned_province = {
					fort_level = 3
				}
			}
		}
		
		provinces_to_highlight = {
			if = {
				limit = {
					TUR = {
						any_owned_province = {
							region = balkan_region
						}
					}
				}
				owned_by = ROOT
				NOT = {
					fort_level = 1
				}
				any_neighbor_province = {
					owned_by = TUR
				}
			}
			else = {
				owned_by = ROOT
				NOT = {
					fort_level = 1
				}
			}
		}
		
		effect = {
			tooltip = {
				add_country_modifier = {
					name = "hun_avenge_varna"
					duration = -1
					desc = hun_first_ottoman_war
				}
			}
			bulgaria_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			silistria_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
		}
		ai_weight = {
			factor = 500	#AI HUngary should WANT to survive against the Ottoman threat
		}
	}
	
	hun_liberate_bulgaria = {
		icon = push_on_to_bulgaria
		required_missions = { hun_the_anatolian_threat }
		position = 7
		
		provinces_to_highlight = {
			OR = {
				area = bulgaria_area
				area = silistria_area
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		
		trigger = {
			num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
				OR = {
					area = bulgaria_area
					area = silistria_area
				}
				value = 6
			}
		}
		
		effect = {
			add_war_exhaustion = -3
			add_country_modifier = {
				name = "hun_vengeance_for_varna"
				duration = 7300
			}
			macedonia_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			thrace_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
		}
		ai_weight = {
			factor = 500
		}
	}
	
	hun_push_on_to_constantinople = {
		icon = end_the_schism
		required_missions = { hun_liberate_bulgaria }
		position = 8
		
		provinces_to_highlight = {
			province_id = 151
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		
		trigger = {
			151 = {
				country_or_non_sovereign_subject_holds = ROOT
			}
		}
		
		effect = {
			add_prestige_or_monarch_power = {
				amount = 30
			}
			add_country_modifier = {
				name = "hun_constantinople"
				duration = 7300
			}
			balkan_region = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			if = {
				limit = {
					151 = {
						culture = turkish
					}
				}
				custom_tooltip = hun_turkish_constantinople_tt_yes
				tooltip = {
					country_event = { id = new_flavour_hun.3 }
					custom_tooltip = hun_constantinople_insight_tt
				}
			}
			else = {
				custom_tooltip = hun_turkish_constantinople_tt_no
				tooltip = {
					country_event = { id = new_flavour_hun.3 }
					custom_tooltip = hun_constantinople_insight_tt
				}
			}
			hidden_effect = {
				if = {
					limit = {
						151 = {
							culture = turkish
						}
					}
					country_event = { id = new_flavour_hun.3 }
				}
			}
		}
		ai_weight = {
			factor = 500
		}
	}
	
	hun_bulwark_of_christianity = {
		icon = mission_sword_of_the_reformation
		required_missions = { hun_push_on_to_constantinople hun_secure_macedonia }
		position = 9
		
		provinces_to_highlight = {
			owner = {
				religion_group = muslim
				OR = {
					culture_group = turko_semitic
					is_neighbor_of = root
					capital_scope = {
						continent = europe
					}
				}
				army_size = root
			}
			ROOT = {
				religion_group = christian
			}
		}
		
		trigger = {
			if = {
				limit = {
					religion_group = christian
				}
				custom_trigger_tooltip = {
					tooltip = emp_hun_bulwark_of_christianity_trigger_tooltip
					NOT = {
						any_country = {
							religion_group = muslim
							OR = {
								culture_group = turko_semitic
								is_neighbor_of = root
								capital_scope = {
									continent = europe
								}
							}
							army_size = root
						}
					}
				}
			}
			else = { #congrats, you've broken it.
				religion_group = root
			}
		}
		
		effect = {
			set_country_flag = hun_pp_on_heathen_wars
			add_country_modifier = {
				name = hun_bulwark_of_christianity
				duration = 7300
			}
			custom_tooltip = hun_winning_wars_against_heathens_tt
		}
	}
	
	hun_dismantle_la_serenissima = {
		icon = byz_aegean_islands
		required_missions = { hun_recover_dalmatia }
		position = 11
		
		trigger = {
			venetia_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
		}
		
		provinces_to_highlight = {
			area = venetia_area
			NOT = {
				country_or_non_sovereign_subject_holds = ROOT
			}
		}
		
		effect = {
			custom_tooltip = hun_trader_scaling_bonus
			set_country_flag = hun_trader_scaling_bonus_flag
			112 = {
				add_trade_modifier = {
					who = ROOT
					duration = -1
					power = 50
					key = hun_adriatic_hegemony
				}
			}
			if = {
				limit = {
					NOT = {
						exists = VEN
					}
				}
				custom_tooltip = hun_ven_removed_tt_yes
				tooltip = {
					add_prestige_or_monarch_power = {
						amount = 30
					}
				}
			}
			else = {
				custom_tooltip = hun_ven_removed_tt_no
				tooltip = {
					add_prestige_or_monarch_power = {
						amount = 30
					}
				}
			}
			hidden_effect = {
				if = {
					limit = {
						NOT = {
							exists = VEN
						}
					}
					add_prestige_or_monarch_power = {
						amount = 30
					}
				}
			}
		}
	}
}

woc_hun_third_branch = {
	slot = 3
	generic = no
	ai = yes
	potential_on_load = {
		has_dlc = "Winds of Change"
	}
	potential = {
		has_dlc = "Winds of Change"
		tag = HUN
		NOT = { map_setup = map_setup_random }
	}
	has_country_shield = yes
	
	hun_fund_the_monasteries = {
		icon = fund_the_monasteries
		required_missions = { }
		position = 1
		
		provinces_to_highlight = {
			owned_by = ROOT
			has_tax_building_trigger = no
			ROOT = {
				NOT = {
					num_of_owned_provinces_with = {
						value = 5
						has_tax_building_trigger = yes
					}
				}
			}
		}
		
		trigger = {
			num_of_owned_provinces_with = {
				value = 5
				has_tax_building_trigger = yes
			}
			if = {
				limit = {
					has_estate = estate_church
				}
				OR = {
					num_of_estate_privileges = { estate = estate_church value = 5 } 
					estate_loyalty = { estate = estate_church loyalty = 65 }
					num_of_estate_agendas_completed = { estate = estate_church value = 2 } 
				}
			}
		}
		
		effect = {
			define_advisor = {
				type = inquisitor
				name = "Dénes Szécsi"
				skill = 2
				culture = hungarian
				religion = ROOT
				cost_multiplier = 0.5
			}
			if = {
				limit = {
					religion = catholic
					capital_scope = {
						NOT = {
							has_cardinal = yes
						}
					}
				}
				custom_tooltip = hun_cardinal_capital_tt_yes
			}
			else = {
				custom_tooltip = hun_cardinal_capital_tt_no
			}
			hidden_effect = {
				if = {
					limit = {
						religion = catholic
						capital_scope = {
							NOT = {
								has_cardinal = yes
							}
						}
					}
					capital_scope = {
						add_cardinal = yes
					}
				}
			}
		}
	}
	
	hun_unity_in_belief = {
		icon = spread_piety
		required_missions = { hun_fund_the_monasteries }
		position = 2
	
		provinces_to_highlight = {
			owned_by = ROOT
			NOT = { religion = ROOT }
		}
		
		trigger = {
			OR = {
				religious_unity = 1
				AND = {
					NOT = {
						any_owned_province = {
							religion = orthodox
							unrest = 1
						}
					}
					development_in_provinces = {
						value = 100
						religion = orthodox
					}
				}
			}
		}
		
		effect = {
			if = {
				limit = {
					religious_unity = 1
				}
				custom_tooltip = hun_religious_unity_yes
				tooltip = {
					custom_tooltip = hun_empower_religious_diplomats_tt
				}
			}
			else = {
				custom_tooltip = hun_religious_unity_no
				tooltip = {
					custom_tooltip = hun_empower_religious_diplomats_tt
				}
			}
			if = {
				limit = {
					NOT = {
						any_owned_province = {
							religion = orthodox
							unrest = 1
						}
					}
					development_in_provinces = {
						value = 100
						religion = orthodox
					}
				}
				custom_tooltip = hun_orthodox_unrest_yes
				tooltip = {
					custom_tooltip = hun_unlock_orthodox_privilege_tt
				}
			}
			else = {
				custom_tooltip = hun_orthodox_unrest_no
				tooltip = {
					custom_tooltip = hun_unlock_orthodox_privilege_tt
				}
			}
			hidden_effect = {
				if = {
					limit = {
						religious_unity = 1
					}
					set_country_flag = hun_empower_religious_diplomats
				}
				else_if = {
					limit = {
						NOT = {
							any_owned_province = {
								religion = orthodox
								unrest = 1
							}
						}
						development_in_provinces = {
							value = 100
							religion = orthodox
						}
					}
					set_country_flag = hun_empower_orthodox_autonomy
				}
			}
		}
	}

	
	hun_weaken_poland = {
		icon = mission_partition_poland
		required_missions = { hun_control_moldavia_new }
		position = 3
		
		provinces_to_highlight = {
			OR = {
				area = malopolska_area
				area = red_ruthenia_area
				area = sandomierz_area
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		
		trigger = {
			OR = {
				num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
					value = 9
					OR = {
						area = malopolska_area
						area = red_ruthenia_area
						area = sandomierz_area
					}
				}
				if = {
					limit = {
						exists = PLC
					}
					total_own_and_non_tributary_subject_development = PLC
					army_size = PLC
				}
				else_if = {
					limit = {
						exists = POL
					}
					total_own_and_non_tributary_subject_development = POL
					army_size = POL
				}
			}
		}
		
		effect = {
			if = {
				limit = {
					exists = POL
				}
				if = {
					limit = {
						valid_for_personal_unions_trigger = yes
						exists = POL
						POL = {
							valid_for_personal_unions_trigger = yes
						}
					}
					custom_tooltip = hun_cb_poland_tt_yes
					tooltip = {
						add_casus_belli = {
							type = cb_restore_personal_union
							months = 300
							target = POL
						}
					}
				}
				else = {
					custom_tooltip = hun_cb_poland_tt_no
					tooltip = {
						add_casus_belli = {
							type = cb_restore_personal_union
							months = 300
							target = POL
						}
					}
				}
			}
			else_if = {
				limit = {
					exists = PLC
				}
				if = {
					limit = {
						valid_for_personal_unions_trigger = yes
						exists = PLC
						PLC = {
							valid_for_personal_unions_trigger = yes
						}
					}
					custom_tooltip = hun_cb_plc_tt_yes
					tooltip = {
						add_casus_belli = {
							type = cb_restore_personal_union
							months = 300
							target = PLC
						}
					}
				}
				else = {
					custom_tooltip = hun_cb_plc_tt_no
					tooltip = {
						add_casus_belli = {
							type = cb_restore_personal_union
							months = 300
							target = PLC
						}
					}
				}
			}
			if = {
				limit = {
					NOT = {
						OR = {
							exists = POL
							exists = PLC
						}
					}
				}
				custom_tooltip = hun_neither_pol_nor_plc_tt_yes
				tooltip = {
					mazovia_area = {
						limit = {
							NOT = { is_permanent_claim = ROOT }
							NOT = { is_core = ROOT }
						}
						add_permanent_claim = ROOT
					}
					central_poland_area = {
						limit = {
							NOT = { is_permanent_claim = ROOT }
							NOT = { is_core = ROOT }
						}
						add_permanent_claim = ROOT
					}
					wielkopolska_area = {
						limit = {
							NOT = { is_permanent_claim = ROOT }
							NOT = { is_core = ROOT }
						}
						add_permanent_claim = ROOT
					}
					kuyavia_area = {
						limit = {
							NOT = { is_permanent_claim = ROOT }
							NOT = { is_core = ROOT }
						}
						add_permanent_claim = ROOT
					}
				}
			}
			else = {
				custom_tooltip = hun_neither_pol_nor_plc_tt_no
				tooltip = {
					mazovia_area = {
						limit = {
							NOT = { is_permanent_claim = ROOT }
							NOT = { is_core = ROOT }
						}
						add_permanent_claim = ROOT
					}
					central_poland_area = {
						limit = {
							NOT = { is_permanent_claim = ROOT }
							NOT = { is_core = ROOT }
						}
						add_permanent_claim = ROOT
					}
					wielkopolska_area = {
						limit = {
							NOT = { is_permanent_claim = ROOT }
							NOT = { is_core = ROOT }
						}
						add_permanent_claim = ROOT
					}
					kuyavia_area = {
						limit = {
							NOT = { is_permanent_claim = ROOT }
							NOT = { is_core = ROOT }
						}
						add_permanent_claim = ROOT
					}
				}
			}
			hidden_effect = {
				if = {
					limit = {
						valid_for_personal_unions_trigger = yes
						exists = PLC
						PLC = {
							valid_for_personal_unions_trigger = yes
						}
					}
					add_casus_belli = {
						type = cb_restore_personal_union
						months = 300
						target = PLC
					}
				}
				else_if = {
					limit = {
						valid_for_personal_unions_trigger = yes
						exists = POL
						POL = {
							valid_for_personal_unions_trigger = yes
						}
					}
					add_casus_belli = {
						type = cb_restore_personal_union
						months = 300
						target = POL
					}
				}
				else = {
					mazovia_area = {
						limit = {
							NOT = { is_permanent_claim = ROOT }
							NOT = { is_core = ROOT }
						}
						add_permanent_claim = ROOT
					}
					central_poland_area = {
						limit = {
							NOT = { is_permanent_claim = ROOT }
							NOT = { is_core = ROOT }
						}
						add_permanent_claim = ROOT
					}
					wielkopolska_area = {
						limit = {
							NOT = { is_permanent_claim = ROOT }
							NOT = { is_core = ROOT }
						}
						add_permanent_claim = ROOT
					}
					kuyavia_area = {
						limit = {
							NOT = { is_permanent_claim = ROOT }
							NOT = { is_core = ROOT }
						}
						add_permanent_claim = ROOT
					}
				}
			}
		}
		ai_weight = {
			factor = 500
		}
	}
	
	hun_jagiellonian_union = {
		icon = mission_pol_throne_bohemia
		required_missions = { hun_weaken_poland }
		position = 4
		
		provinces_to_highlight = {
			OR = {
				area = mazovia_area
				area = central_poland_area
				area = wielkopolska_area
				area = kuyavia_area
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
			ROOT = {
				NOT = {
					num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
						value = 12 #out of 15
						OR = {
							area = mazovia_area
							area = central_poland_area
							area = wielkopolska_area
							area = kuyavia_area
						}
					}
				}
			}
		}
		
		trigger = {
			num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
				value = 12 #out of 15
				OR = {
					area = mazovia_area
					area = central_poland_area
					area = wielkopolska_area
					area = kuyavia_area
				}
			}
		}
		
		effect = {
			add_accepted_culture_or_dip_power = {
				culture = polish
				dip_reward = yes 
				free = yes
			}
			set_country_flag = hun_polish_culture_bonus
			add_country_modifier = {
				name = hun_polish_brotherhood
				duration = -1 
				desc = hun_as_long_as_polish_accepted
			}
			west_prussia_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT	}
					NOT = { is_core = ROOT	}
				}
				add_permanent_claim = ROOT
			}
			east_prussia_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT	}
					NOT = { is_core = ROOT	}
				}
				add_permanent_claim = ROOT
			}
			yedisan_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			zaporizhia_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			ruthenia_region = {
				limit = {
					NOT = { is_permanent_claim = ROOT	}
					NOT = { is_core = ROOT	}
				}
				add_permanent_claim = ROOT
			}
		}
		ai_weight = {
			factor = 500
		}
	}
	
	hun_teutonic_advance = {
		icon = mission_marienburg
		required_missions = { hun_jagiellonian_union }
		position = 6
		
		trigger = {
			41 = {
				country_or_non_sovereign_subject_holds = ROOT	
			}
			43 = {
				country_or_non_sovereign_subject_holds = ROOT	
			}
			num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
				OR = {
					area = east_prussia_area
					area = west_prussia_area
				}
				value = 6
			}
		}
		
		provinces_to_highlight = {
			OR = {
				area = east_prussia_area
				area = west_prussia_area
			}
			NOT = {
				country_or_non_sovereign_subject_holds = ROOT
			}
		}
		
		effect = {
			41 = {
				add_base_production = 2
				add_center_of_trade_level = 1
			}
			43 = {
				add_base_production = 2
				add_center_of_trade_level = 1
			}
			custom_tooltip = hun_empty
			43 = {
				add_trade_modifier = {
					who = ROOT
					duration = 10950
					power = 50
					key = hun_restoring_amber_road
				}
			}
		}
	}
	
	hun_strengthen_the_vegvar = {
		icon = mission_strengthen_the_vegvar
		required_missions = { hun_the_anatolian_threat }
		position = 7
		
		trigger = {
			calc_true_if = {
				all_owned_province = {
					any_neighbor_province = {
						NOT = { owned_by = ROOT }
					}
					has_fort_building_trigger = yes
					num_of_times_improved = 3
				}
				amount = 5
			}
		}
		
		provinces_to_highlight = {
			owned_by = ROOT
			any_neighbor_province = {
				NOT = { owned_by = ROOT }
			}
			has_fort_building_trigger = yes
			NOT = {
				num_of_times_improved = 3
			}
		}
		
		effect = {
			custom_tooltip = hun_vegvar_bonus_mil_tt
			unlock_estate_privilege = { estate_privilege = estate_nobles_vegvar_system }
			hidden_effect = {
				every_owned_province = {
					limit = {
						any_neighbor_province = {
							NOT = { owned_by = ROOT }
						}
						has_fort_building_trigger = yes
						num_of_times_improved = 3
					}
					add_base_manpower = 1
				}
			}
		}
	}
	
	hun_secure_macedonia = {
		icon = retake_thessaly
		required_missions = { hun_liberate_bulgaria }
		position = 8
		
		provinces_to_highlight = {
			area = macedonia_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		
		trigger = {
		    macedonia_area = {
			    type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
		}
		
		effect = {
			add_yearly_manpower = 2.5
			define_advisor = {
				type = commandant
				skill = 3
				religion = ROOT
				culture = ROOT
				cost_multiplier = 0.25
			}
		}
		ai_weight = {
			factor = 500
		}
	}
	
	hun_bohemian_borderlands = {
		icon = bohemian_borderlands
		required_missions = { hun_the_hungarian_succession }
		position = 9
		
		provinces_to_highlight = {
			OR = {
				area = moravia_area
				area = silesia_area
				area = lusatia_area
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
			ROOT = {
				NOT = {
					num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
						value = 5
						OR = {
							area = moravia_area
							area = silesia_area
							area = lusatia_area
						}
					}
				}
			}
		}
		
		trigger = {
			num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
				value = 5
				OR = {
					area = moravia_area
					area = silesia_area
					area = lusatia_area
				}
			}
			if = {
				limit = {
					BOH = {
						is_subject_of = ROOT
					}
				}
				BOH = {
					NOT = {
						liberty_desire = 50
					}
				}
			}
		}
		
		effect = {
			if = {
				limit = {
					exists = BOH
					valid_for_personal_unions_trigger = yes
					BOH = {
						valid_for_personal_unions_trigger = yes
					}
				}
				custom_tooltip = hun_bohemia_exists_tt_yes
				tooltip = {
					add_casus_belli = {
						type = cb_restore_personal_union
						months = 300
						target = BOH
					}
				}
			}
			else = {
				custom_tooltip = hun_bohemia_exists_tt_no
				tooltip = {
					add_casus_belli = {
						type = cb_restore_personal_union
						months = 300
						target = BOH
					}
				}
			}
			if = {
				limit = {
					OR = {
						NOT = {
							exists = BOH
						}
						BOH = {
							NOT = {
								valid_for_personal_unions_trigger = yes
							}
						}
						NOT = {
							valid_for_personal_unions_trigger = yes
						}
					}
				}
				custom_tooltip = hun_bohemia_doesnt_exist_tt_yes
				tooltip = {
					bohemia_area = {
						limit = {
							NOT = { is_core = ROOT }
							NOT = { is_permanent_claim = ROOT }
						}
						add_permanent_claim = ROOT
					}
					erzgebirge_area = {
						limit = {
							NOT = { is_core = ROOT }
							NOT = { is_permanent_claim = ROOT }
						}
						add_permanent_claim = ROOT
					}
				}
			}
			else = {
				custom_tooltip = hun_bohemia_doesnt_exist_tt_no
				tooltip = {
					bohemia_area = {
						limit = {
							NOT = { is_core = ROOT }
							NOT = { is_permanent_claim = ROOT }
						}
						add_permanent_claim = ROOT
					}
					erzgebirge_area = {
						limit = {
							NOT = { is_core = ROOT }
							NOT = { is_permanent_claim = ROOT }
						}
						add_permanent_claim = ROOT
					}
				}
			}
			hidden_effect = {	
				if = {
					limit = {
						exists = BOH
						valid_for_personal_unions_trigger = yes
						BOH = {
							valid_for_personal_unions_trigger = yes
						}
					}
					add_casus_belli = {
						type = cb_restore_personal_union
						months = 300
						target = BOH
					}
				}
				else = {
					bohemia_area = {
						limit = {
							NOT = { is_core = ROOT }
							NOT = { is_permanent_claim = ROOT }
						}
						add_permanent_claim = ROOT
					}
					erzgebirge_area = {
						limit = {
							NOT = { is_core = ROOT }
							NOT = { is_permanent_claim = ROOT }
						}
						add_permanent_claim = ROOT
					}
				}
			}
		}
	}
	
	hun_crown_of_wenceslas = {
		icon = mission_crown_of_wenceslas
		required_missions = { hun_bohemian_borderlands }
		position = 10

		provinces_to_highlight = {
			OR = {
				area = bohemia_area
				area = erzgebirge_area
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		
		trigger = { 
			bohemia_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			erzgebirge_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			is_subject = no
			if = {
				limit = {
					has_dlc = "Emperor"
				}
				NOT = { active_imperial_incident = any }
			}
			if = {
				limit = {
					BOH = {
						is_subject_of = ROOT
					}
				}
				NOT = {
					BOH = {
						liberty_desire = 50
					}
				}
			}
		}
		
		effect = {
			add_power_projection = {
				type = mission_rewards_power_projection
				amount = 25
			}
			add_country_modifier = {
				name = hun_support_of_bohemian_estates
				duration = 7300
			}
			if = {
				limit = {
					has_dlc = "Emperor"
				}
				if = {
					limit = {
						BOH = { is_elector = yes }
						OR = {
							hre_religion_locked = no
							hre_religion = root
						}
						senior_union_with = BOH
						capital_scope = {
							continent = europe
						}
						religion_group = christian
					}
					custom_tooltip = hun_emperor_bohemia_pu_tt_yes
					tooltip = {
						country_event = { id = new_flavour_hun.1 }
						custom_tooltip = hun_incident_event_insight_tt
					}
				}
				else = {
					custom_tooltip = hun_emperor_bohemia_pu_tt_no
					tooltip = {
						country_event = { id = new_flavour_hun.1 }
						custom_tooltip = hun_incident_event_insight_tt
					}
				}
			}
			else = {
				if = {
					limit = {
						senior_union_with = BOH
					}
					custom_tooltip = hun_bohemia_pu_tt_yes
					tooltip = {
						BOH = {
							add_liberty_desire = -50
						}
					}
				}
				else = {
					custom_tooltip = hun_bohemia_pu_tt_no
					tooltip = {
						BOH = {
							add_liberty_desire = -50
						}
					}
				}
			}
			hidden_effect = {
				if = {
					limit = {
						has_dlc = "Emperor"
					}
					if = {
						limit = {
							BOH = { is_elector = yes }
							OR = {
								hre_religion_locked = no
								hre_religion = root
							}
							senior_union_with = BOH
							capital_scope = {
								continent = europe
							}
							religion_group = christian
						}
						country_event = { id = new_flavour_hun.1 }
					}
				}
				else_if = {
					limit = {
						NOT = {
							has_dlc = "Emperor"
						}
					}
					if = {
						limit = {
							senior_union_with = BOH
						}
						BOH = {
							add_liberty_desire = -50
						}
					}
				}
			}
		}
	}
}

woc_hun_fourth_branch = {
	slot = 4
	generic = no
	ai = yes
	potential_on_load = {
		has_dlc = "Winds of Change"
	}
	potential = {
		has_dlc = "Winds of Change"
		tag = HUN
		NOT = { map_setup = map_setup_random }
	}
	has_country_shield = yes
	
	hun_a_strong_economy = {
		icon = balance_the_estates
		required_missions = { }
		position = 1
		
		trigger = {
			share_of_starting_income = 2
		}
		
		effect = {
			add_years_of_income = 0.25
			capital_scope = {	
				add_or_upgrade_production_building = yes
			}
		}
	}
	
	hun_bibliotheca_corviniana = {
		icon = bibliotheca_corviana
		required_missions = { hun_a_strong_economy hun_fund_the_monasteries }
		position = 2
		
		provinces_to_highlight = {
			province_id = 153
			OR = {
				NOT = { owned_by = ROOT }
				NOT = { is_core = ROOT }
			}
		}
		
		trigger = {
			has_institution = renaissance
			OR = {
				prestige = 50
				advisor = artist
			}
			owns_core_province = 153
		}
		
		effect = {
			country_event = { id = flavor_hun.47 }
			if = {
				limit = {
					has_dlc = "Leviathan"
				}
				custom_tooltip = hun_corviniana_insight_leviathan_tt
				tooltip = {
					add_country_modifier = {
						name = hun_corviana_library
						duration = 7300
					}
				}
			}
			else = {
				custom_tooltip = hun_corviniana_insight_no_leviathan_tt
				tooltip = {
					add_country_modifier = {
						name = hun_corviana_library
						duration = 7300
					}
				}
			}
		}
	}
	
	hun_universitas_istropolitana = {
		icon = mission_early_modern_university
		required_missions = { hun_bibliotheca_corviniana }
		position = 3
		
		provinces_to_highlight = {
			province_id = 1772
			NOT = {
				AND = {
					owned_by = root
					is_state_core = root
					development = 25
					has_building = university
				}
			}
		}
		
		trigger = {
			owns_core_province = 1772
			1772 = {
				OR = {
					development = 25
					has_building = university
				}
			}
		}
		
		effect = {
			custom_tooltip = hun_unlocking_nis_tt
			set_country_flag = hun_national_idea_bonus
			define_advisor = {
				type = diplomat
				name = "János Vitéz"
				skill = 3
				culture = hungarian
				religion = ROOT
				cost_multiplier = 0.25
			}
			hidden_effect = {
				if = {
					limit = {
						has_country_flag = hun_unlocked_first_idea
					}
					change_government_reform_progress =  25
				}
				if = {
					limit = {
						has_country_flag = hun_unlocked_second_idea
					}
					change_government_reform_progress =  25
				}
				if = {
					limit = {
						has_country_flag = hun_unlocked_third_idea
					}
					change_government_reform_progress =  25
				}
				if = {
					limit = {
						has_country_flag = hun_unlocked_fourth_idea
					}
					change_government_reform_progress =  25
				}
				if = {
					limit = {
						has_country_flag = hun_unlocked_fifth_idea
					}
					change_government_reform_progress =  25
				}
				if = {
					limit = {
						has_country_flag = hun_unlocked_sixth_idea
					}
					change_government_reform_progress =  25
				}
				if = {
					limit = {
						has_country_flag = hun_unlocked_seventh_idea
					}
					change_government_reform_progress =  25
				}
			}
		}
	}
	
	hun_the_renaissance_king = {
		icon = mission_the_renaissance_king_Mathias_Corvinus
		required_missions = { hun_universitas_istropolitana }
		position = 4
		
		trigger = {
			university = 10
			OR = {
				DIP = 5
				monthly_dip = 12
			}
			has_adm_advisor_3 = yes
			has_dip_advisor_3 = yes
			has_mil_advisor_3 = yes
		}
		
		provinces_to_highlight = {
			owned_by = ROOT
			NOT = {
				has_building = university
			}
		}
		
		effect = {
			set_country_flag = hun_refund_mana_on_tech
			custom_tooltip = hun_refund_mana_on_tech_tt
			add_country_modifier = {
				name = hun_patrons_of_art
				duration = -1
			}
		}
	}
	
	hun_found_budapest = {
		icon = a_strong_government
		required_missions = { hun_a_strong_government }
		position = 6
		
		trigger = {
			owns = 153
			153 = {
				development = 40
			}
			153 = {
				has_tax_building_trigger = yes
			}
			153 = {
				has_trade_building_trigger = yes
			}
			153 = {
				has_production_building_trigger = yes
			}
		}
		
		provinces_to_highlight = {
			province_id = 153
		}
		
		effect = {
			set_country_flag = hun_bonus_dev_budapest
			153 = {
				change_province_name = "Budapest"
				rename_capital = "Budapest"
			}
			153 = {
				add_province_modifier = {
					name = hun_pearl_on_the_danube
					duration = -1
				}
			}
			custom_tooltip = hun_developing_budapest_tt
		}
	}
	
	hun_the_order_of_the_dragon = {
		icon = reformatio_sigismundi
		required_missions = { hun_the_anatolian_threat }
		position = 7
		
		trigger = {
			if = {
				limit = {
					has_dlc = "Golden Century"
				}
				num_of_owned_provinces_with = {
					holy_order = order_of_the_dragon_order
					value = 30
				}
			}
			else = {
				num_of_owned_provinces_with = {
					base_manpower = 5
					value = 5
				}
			}
		}
		
		provinces_to_highlight = {
			if = {
				limit = {
					has_dlc = "Golden Century"
				}
				owned_by = ROOT
				NOT = {
					holy_order = order_of_the_dragon_order
				}
			}
			else = {
				owned_by = ROOT
				base_manpower = 5
			}
		}
		
		effect = {
			add_country_modifier = {
				name = "hun_expanding_the_order"
				duration = 7300
			}
			if = {
				limit = {
					has_dlc = "Golden Century"
				}
				custom_tooltip = hun_holy_order_army_tradition_tt
			}
			else = {
				add_army_tradition_or_mil_power = { amount = 10 }
			}
			hidden_effect = {
				every_owned_province = {
					limit = {
						holy_order = order_of_the_dragon_order
					}
					owner = {
						add_army_tradition = 0.5
					}
				}
			}
		}
	}
	
	hun_the_hungarian_succession = {
		icon = the_hungarian_succession
		required_missions = { }
		position = 8
		
		trigger = {
			custom_trigger_tooltip = {
				OR = {
					has_country_flag = hun_has_had_matthias_corvinus_event
					is_year = 1457
				}
				tooltip = emp_hun_hungarian_succession_tooltip
			}
			has_regency = no
			if = {
				limit = {
					government = monarchy
					has_government_attribute = heir
				}
				has_heir = yes
			}
		}
		
		effect = {
			custom_tooltip = add_5_crown_land_share
			hidden_effect = {
				change_estate_land_share = {
				estate = all
				share = -5
				}
			}
			add_prestige_or_monarch_power = {
				amount = 20
			}
			moravia_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			silesia_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			lusatia_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
		}
	}
	
	hun_the_imperial_ambition = {
		icon = holy_state
		required_missions = { hun_crown_of_wenceslas hun_overshadow_austria }
		position = 11
		
		trigger = {
			OR = {
				NOT = { hre_size = 1 }
				is_emperor = yes
			}
		}
		
		provinces_to_highlight = {
			is_part_of_hre = yes
		}
		
		effect = {
			if = {
				limit = {
					is_emperor = yes
				}
				custom_tooltip = hun_emperor_hre_tt_yes
				tooltip = {
					custom_tooltip = hun_reelection_bonus_tt
					add_ruler_modifier = {
						name = hun_first_hungarian_emperor
						duration = -1
					}
				}
			}
			else = {
				custom_tooltip = hun_emperor_hre_tt_no
				tooltip = {
					custom_tooltip = hun_reelection_bonus_tt
					add_ruler_modifier = {
						name = hun_first_hungarian_emperor
						duration = -1
					}
				}
			}
			if = {
				limit = {
					NOT = { hre_size = 1 }
				}
				custom_tooltip = hun_dismantle_hre_tt_yes
				tooltip = {
					add_permanent_power_projection = {
						type = hun_permanent_power_projection
						amount = 20
					}
					add_country_modifier = {
						name = hun_bane_of_the_empire
						duration = -1
					}
				}
			}
			else = {
				custom_tooltip = hun_dismantle_hre_tt_no
				tooltip = {
					add_permanent_power_projection = {
						type = hun_permanent_power_projection
						amount = 20
					}
					add_country_modifier = {
						name = hun_bane_of_the_empire
						duration = -1
					}
				}
			}
			hidden_effect = {
				if = {
					limit = {
						is_emperor = yes
					}
					set_country_flag = hun_imperial_reelection_bonus
					add_ruler_modifier = {
						name = hun_first_hungarian_emperor
						duration = -1
					}
				}
				else_if = {
					limit = {
						NOT = { hre_size = 1 }
					}
					add_permanent_power_projection = {
						type = hun_permanent_power_projection
						amount = 20
					}
					add_country_modifier = {
						name = hun_bane_of_the_empire
						duration = -1
					}
				}
			}
		}
	}
}

woc_hun_fifth_branch = {
	slot = 5
	generic = no
	ai = yes
	potential_on_load = {
		has_dlc = "Winds of Change"
	}
	potential = {
		has_dlc = "Winds of Change"
		tag = HUN
		NOT = { map_setup = map_setup_random }
	}
	has_country_shield = yes
	
	hun_expand_the_mint = {
		icon = dominant_economy
		required_missions = { }
		position = 1
		
		trigger = {
			owns = 154
			154 = {
				base_production = 6
			}
			OR = {
				advisor = natural_scientist
				gold_income_percentage = 0.2
			}
		}
		
		provinces_to_highlight = {
			province_id = 154
		}
		
		effect = {
			add_inflation = -3
			154 = {
				add_province_modifier = {
					name = hun_expand_mining_rights
					duration = 10950
				}
			}
			if = {
				limit = {
					gold_income_percentage = 0.4
				}
				custom_tooltip = hun_gold_income_tt_yes
				tooltip = {
					154 = {
						add_base_production = 2
					}
				}
			}
			else = {
				custom_tooltip = hun_gold_income_tt_no
				tooltip = {
					154 = {
						add_base_production = 2
					}
				}
			}
			hidden_effect = {
				if = {
					limit = {
						gold_income_percentage = 0.4
					}
					154 = {
						add_base_production = 2
					}
				}
			}
		}
	}
	
	hun_the_great_city_of_buda = {
		icon = the_great_city_of_buda
		required_missions = { hun_expand_the_mint hun_a_strong_economy }
		position = 2
		
		provinces_to_highlight = {
			OR = {
				AND = {
					province_id = 134
					153 = {
						NOT = {
							higher_development_than = 266
						}
					}
				}
				AND = {
					province_id = 266
					153 = {
						NOT = {
							higher_development_than = 266
						}
					}
				}
			}
		}
		
		trigger = {
			153 = {
				higher_development_than = 134
				higher_development_than = 266
			}
		}
		
		effect = {
			153 = {
				add_province_modifier = {
					name = hun_great_city_buda
					duration = 7300
				}
			}
			country_event = { id = flavor_hun.53 }
			custom_tooltip = hun_pest_production_insight_tt
		}
	}
	
	hun_develop_free_royal_towns = {
		icon = mission_eastern_european_city
		required_missions = { hun_the_great_city_of_buda }
		position = 3
		
		trigger = {
			calc_true_if = {
				all_owned_province = {
					province_has_center_of_trade_of_level = 1
					region = carpathia_region
					development = 20
				}
				amount = 3
			}
		}
		
		provinces_to_highlight = {
			owned_by = ROOT
			region = carpathia_region
			province_has_center_of_trade_of_level = 1
			NOT = {
				development = 20
			}
		}
		
		effect = {
			unlock_estate_privilege = { estate_privilege = estate_burghers_hungarian_royal_cities }
		}
	}
	
	hun_fertile_lands_of_pannonia = {
		icon = mission_pol_develop_countryside
		required_missions = { hun_develop_free_royal_towns }
		position = 4
		
		provinces_to_highlight = {
			owned_by = ROOT
			region = carpathia_region
			OR = {
				has_production_building_trigger = no
				NOT = { base_production = 6 }
			}
		}
		
		trigger = {
			calc_true_if = {
				all_owned_province = {
					region = carpathia_region
					base_production = 6
				}
				amount = 10
			}
			calc_true_if = {
				all_owned_province = {
					region = carpathia_region
					has_production_building_trigger = yes
				}
				amount = 10
			}
		}
		
		effect = {
			add_years_of_owned_provinces_production_income = {
				years = 1
				trigger = {
					has_production_building_trigger = yes
				}
				custom_tooltip = INCOME_FROM_WORKSHOPS_DESC
			}
			carpathia_region = {
				add_province_modifier = {
					name = hun_fertile_lands
					duration = 5475
				}
			}
		}
	}
	
	hun_a_strong_government = {
		icon = mission_apostolic_kingdom
		required_missions = { hun_fertile_lands_of_pannonia }
		position = 5
		
		provinces_to_highlight = {
			owned_by = ROOT
			NOT = {
				OR = {
					has_building = courthouse
					has_building = town_hall
				}
			}
		}
		
		trigger = {
			reform_level = 7
			crown_land_share = 60
			calc_true_if = {
				all_owned_province = {
					OR = {
						has_building = courthouse
						has_building = town_hall
					}
				}
				amount = 10
			}
		}
		
		effect = {
			change_government_reform_progress = 100
			if = {
				limit = {
					has_dlc = "Leviathan"
				}
				add_country_modifier = {
					name = hun_strengthen_the_government
					duration = 3650
				}
				custom_tooltip = hun_centralize_government
			}
			else = {
				add_country_modifier = {
					name = hun_golden_age_of_hungary
					duration = 9125
				}
			}
		}
	}
	
	hun_address_the_ethnic_situation = { 
		icon = mission_address_the_ethnic_situation
		required_missions = { hun_a_strong_government }
		position = 6
		
		provinces_to_highlight = {
			culture = hungarian
		}
		
		trigger = {
			num_accepted_cultures = 3
			development_in_provinces = {
				value = 250
				culture_group = carpathian
			}
		}
		
		effect = {
			country_event = { id = flavor_hun.38 }
			custom_tooltip = hun_ethnic_situation_insight_tt
		}
	}
	
		hun_a_multicultural_empire = { 
		icon = multicultural_empire 
		required_missions = { hun_address_the_ethnic_situation }
		position = 7
		
		provinces_to_highlight = {
			AND = {
				owned_by = ROOT
				OR = {
					unrest = 1
					nationalism = 1 
					local_autonomy = 1 
				}
				ROOT = {
					NOT = {
						num_of_owned_provinces_with = {
							value = 30
							NOT = { unrest = 1 }
							NOT = { nationalism = 1 }
							NOT = { local_autonomy = 1 }
						}
					}
				}
			}
		}
		
		trigger = {
			stability = 3
			num_accepted_cultures = 4
			OR = {
				tag = AUH
				AND = {
					total_development = 1000
					OR = {
						reform_level = 10
						crown_land_share = 80
					}
				}
			}
			num_of_owned_provinces_with = {
				value = 30
				NOT = { unrest = 1 }
				NOT = { nationalism = 1 }
				NOT = { local_autonomy = 1 }
			}
		}
		
		effect = {
			custom_tooltip = hun_austria_hungary_requirement_tt
			set_country_flag = hun_keep_order_of_the_dragon
			hidden_effect = {
				unlock_government_reform = {
					government_reform = imperial_hungarian_government
				}
			}
			if = {
				limit = {
					government = monarchy
				}
				add_government_reform = imperial_hungarian_government
			}
			else = {
				change_government_reform_progress = 100
			}
			custom_tooltip = hun_perma_access_order_of_the_dragon
		}
	}
	
	hun_weaken_the_habsburgs = {
		icon = mission_the_austrian_succession
		required_missions = { hun_the_hungarian_succession }
		position = 9
		
		provinces_to_highlight = {
			country_or_non_sovereign_subject_holds = HAB
			HAB = {
				num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
					value = 13
				}
			}
		}
		trigger = {
			OR = {
				NOT = { exists = HAB }
				HAB = {
					custom_trigger_tooltip = {
						tooltip = emp_hun_weaken_austria_trigger_tooltip
						NOT = {
							num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
								value = 14
							}
						}
					}
					is_emperor = no
					NOT = { army_size = ROOT }
				}
			}
		}
		
		effect = {
			if = {
				limit = {
					exists = HAB
					valid_for_personal_unions_trigger = yes
					HAB = {
						valid_for_personal_unions_trigger = yes
					}
				}
				custom_tooltip = hun_austria_exists_tt_yes
				tooltip = {
					add_casus_belli = {
						type = cb_restore_personal_union
						months = 300
						target = HAB
					}
				}
			}
			else = {
				custom_tooltip = hun_austria_exists_tt_no
				tooltip = {
					add_casus_belli = {
						type = cb_restore_personal_union
						months = 300
						target = HAB
					}
				}
			}
			if = {
				limit = {
					OR = {
						NOT = {
							exists = HAB
						}
						NOT = {
							HAB = {
								valid_for_personal_unions_trigger = yes
							}
						}
					}
				}
				custom_tooltip = hun_austria_doesnt_exist_tt_yes
				tooltip = {
					austria_proper_area = {
						limit = {
							NOT = { is_core = ROOT }
							NOT = { is_permanent_claim = ROOT }
						}
						add_permanent_claim = ROOT
					}
					inner_austria_area = {
						limit = {
							NOT = { is_core = ROOT }
							NOT = { is_permanent_claim = ROOT }
						}
						add_permanent_claim = ROOT
					}
				}
			}
			else = {
				custom_tooltip = hun_austria_doesnt_exist_tt_no
				tooltip = {
					austria_proper_area = {
						limit = {
							NOT = { is_core = ROOT }
							NOT = { is_permanent_claim = ROOT }
						}
						add_permanent_claim = ROOT
					}
					inner_austria_area = {
						limit = {
							NOT = { is_core = ROOT }
							NOT = { is_permanent_claim = ROOT }
						}
						add_permanent_claim = ROOT
					}
				}
			}
			hidden_effect = {	
				if = {
					limit = {
						exists = HAB
						valid_for_personal_unions_trigger = yes
						HAB = {
							valid_for_personal_unions_trigger = yes
						}
					}
					add_casus_belli = {
						type = cb_restore_personal_union
						months = 300
						target = HAB
					}
				}
				else = {
					austria_proper_area = {
						limit = {
							NOT = { is_core = ROOT }
							NOT = { is_permanent_claim = ROOT }
						}
						add_permanent_claim = ROOT
					}
					inner_austria_area = {
						limit = {
							NOT = { is_core = ROOT }
							NOT = { is_permanent_claim = ROOT }
						}
						add_permanent_claim = ROOT
					}
				}
			}
		}
	}
	
	hun_overshadow_austria = {
		icon = humiliate_austria
		required_missions = { hun_weaken_the_habsburgs }
		position = 10
		
		provinces_to_highlight = {
			OR = {
				AND = {
					OR = {
						area = austria_proper_area
						area = inner_austria_area
						area = carinthia_area
					}
					NOT = { country_or_non_sovereign_subject_holds = ROOT }
					NOT = {
						ROOT = {
							num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
								value = 9
								OR = {
									area = austria_proper_area
									area = inner_austria_area
									area = carinthia_area
								}
							}
						}
					}
				}
				AND = {
					province_id = 134
					NOT = { country_or_non_sovereign_subject_holds = ROOT }
				}
			}
		}
		trigger = {
			owns_or_non_sovereign_subject_of = 134 #Vienna
			num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
				value = 9
				OR = {
					area = austria_proper_area
					area = inner_austria_area
					area = carinthia_area
				}
			}
		}
		effect = {
			if = {
				limit = {
					NOT = { government_rank = 3 }
				}
				set_government_rank = 3
			}
			custom_tooltip = hun_empty
			country_event = { id = flavor_hun.41 }
			custom_tooltip = hun_fate_of_the_empire_insight_tt
		}
	}
}