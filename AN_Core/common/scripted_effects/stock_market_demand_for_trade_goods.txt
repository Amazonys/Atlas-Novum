demand_from_province_dev = {	#this serves a as a baseline for many trade goods
								#base is balanced with an excel sheet to make a number that is around 5
								#multiplier is an extra multiplier to reduce it to a lower number, like 2 for grain.
								#trade_good_id is obvious
								
								#this is designed to provide a stable basis for most trade goods
	owner = {
		set_variable = {
			which = tempvar
			which = tempvardev
		}
		multiply_variable = { 
			which = tempvar
			value = $base$
		}
		[[multiplier]
			multiply_variable = { 
				which = tempvar
				value = $multiplier$
			}
		]
		set_variable = {
			which = modifier_var
			value = 1
		}
		[[modifier_1] $modifier_1$ ]
		[[modifier_2] $modifier_2$ ]
		[[modifier_3] $modifier_3$ ]
		[[modifier_4] $modifier_4$ ]
		[[modifier_5] $modifier_5$ ]
		[[modifier_6] $modifier_6$ ]
		[[modifier_7] $modifier_7$ ]
		[[modifier_8] $modifier_8$ ]
		[[modifier_9] $modifier_9$ ]
		multiply_variable = { 
			which = tempvar
			which = modifier_var
		}
		change_variable = {
			which = stock_market_demand_for_$trade_good_id$
			which = tempvar
		}
	}
}

on_supply_creation_building_built = {
	set_province_flag = supply_creation_building
}
on_demand_creation_building_built = {
	set_province_flag = demand_creation_building
}
on_supply_creation_building_destroyed = {
	if = {
		limit = {
			NOT = {
				OR = {
					has_building = fishing_dock
					has_building = salt_mine
					has_building = mine
					has_building = forester
					has_building = crop_farm
					has_building = livestock_farm
				}
			}
		}
		clr_province_flag = supply_creation_building 
	}
}
on_demand_creation_building_destroyed = {
	if = {
		limit = {
			NOT = {
				OR = {
					has_building = printing_house
					has_building = coffee_inn
					has_building = cannon_tower
					has_building = brewery
					has_building = tailor
					has_building = mayoral_house
					has_building = fort_15th
					has_building = fort_16th
					has_building = fort_17th
					has_building = fort_18th
				}
			}
		}
		clr_province_flag = supply_creation_building 
	}
}
update_supply_and_demand_based_on_buildings = {
	if = {
		limit = {
			has_province_flag = supply_creation_building
		}
		if = {
			limit = {
				has_building = crop_farm
			}
			owner = {
				change_variable = {
					which = country_stock_market_supply_for_0
					value = 50
				}
			}
		}
		if = {
			limit = {
				has_building = livestock_farm
			}
			owner = {
				change_variable = {
					which = country_stock_market_supply_for_24
					value = 50
				}
			}
		}
		if = {
			limit = {
				has_building = mine
			}
			owner = {
				change_variable = {
					which = country_stock_market_supply_for_8
					value = 50
				}
				change_variable = {
					which = country_stock_market_supply_for_10
					value = 50
				}
			}
		}
		if = {
			limit = {
				has_building = salt_mine
			}
			owner = {
				change_variable = {
					which = country_stock_market_supply_for_6
					value = 50
				}
			}
		}
		if = {
			limit = {
				has_building = forester
			}
			owner = {
				change_variable = {
					which = country_stock_market_supply_for_7
					value = 50
				}
			}
			if = {
				limit = {
					OR = {
						has_climate = tropical
						has_terrain = jungle
					}
				}
				owner = {
					change_variable = {
						which = country_stock_market_supply_for_23
						value = 50
					}
				}
			}
		}
		if = {
			limit = {
				has_building = fishing_dock
			}
			owner = {
				change_variable = {
					which = country_stock_market_supply_for_4
					value = 50
				}
			}
		}
	}
	if = {
		limit = {
			has_province_flag = demand_creation_building
		}
		if = {
			limit = {
				has_building = printing_house
			}
			owner = {
				change_variable = {
					which = stock_market_demand_for_27
					value = 200
				}
			}
		}
		if = {
			limit = {
				has_building = coffee_inn
			}
			owner = {
				change_variable = {
					which = stock_market_demand_for_16
					value = 50
				}
			}
		}
		if = {
			limit = {
				has_building = cannon_tower
			}
			owner = {
				change_variable = {
					which = stock_market_demand_for_8
					value = 25
				}
				change_variable = {
					which = stock_market_demand_for_10
					value = 25
				}
			}
		}
		if = {
			limit = {
				has_building = brewery
			}
			if = {
				limit = {
					trade_goods = wine
				}
				owner = {
					change_variable = {
						which = stock_market_demand_for_1
						value = 50
					}
				}
			}
			else = {
				owner = {
					change_variable = {
						which = stock_market_demand_for_0
						value = 50
					}
				}
			}
		}
		if = {
			limit = {
				has_building = tailor
			}
			owner = {
				change_variable = {
					which = stock_market_demand_for_3
					value = 35
				}
				change_variable = {
					which = stock_market_demand_for_22
					value = 15
				}
			}
		}
		if = {
			limit = {
				has_building = mayoral_house
			}
			owner = {
				change_variable = {
					which = stock_market_demand_for_27
					value = 60
				}
				change_variable = {
					which = stock_market_demand_for_26
					value = 40
				}
			}
		}
		if = {
			limit = {
				has_building = fort_15th
			}
			owner = {
				change_variable = {
					which = stock_market_demand_for_6
					value = 5
				}
			}
		}
		else_if = {
			limit = {
				has_building = fort_16th
			}
			owner = {
				change_variable = {
					which = stock_market_demand_for_6
					value = 10
				}
			}
		}
		else_if = {
			limit = {
				has_building = fort_17th
			}
			owner = {
				change_variable = {
					which = stock_market_demand_for_6
					value = 15
				}
			}
		}
		else_if = {
			limit = {
				has_building = fort_18th
			}
			owner = {
				change_variable = {
					which = stock_market_demand_for_6
					value = 20
				}
			}
		}
		else = { }
	}
}

update_demand_based_on_craze_individual = {
	if = {
		limit = {
			has_province_modifier = stock_market_$trade_good_id$_craze_province
		}
		owner = {
			set_variable = {
				which = tempvar
				which = tempvardev
			}
			multiply_variable = { 
				which = tempvar
				value = 0.35
			}
			change_variable = {
				which = stock_market_demand_for_$trade_good_id$
				which = tempvar
			}
		}
	}
	else_if ={
		limit = {
			has_province_flag = stock_market_$trade_good_id$_consumption_province
		}
		owner = {
			set_variable = {
				which = tempvar
				which = tempvardev
			}
			multiply_variable = { 
				which = tempvar
				value = 0.1
			}
			change_variable = {
				which = stock_market_demand_for_$trade_good_id$
				which = tempvar
			}
		}
	}
	else = { }
}

update_demand_based_on_craze = {
	update_demand_based_on_craze_individual = { trade_good_id = 12 }
	update_demand_based_on_craze_individual = { trade_good_id = 13 }
	update_demand_based_on_craze_individual = { trade_good_id = 14 }
	update_demand_based_on_craze_individual = { trade_good_id = 15 }
	update_demand_based_on_craze_individual = { trade_good_id = 16 }
	update_demand_based_on_craze_individual = { trade_good_id = 17 }
	update_demand_based_on_craze_individual = { trade_good_id = 18 }
	update_demand_based_on_craze_individual = { trade_good_id = 19 }
	update_demand_based_on_craze_individual = { trade_good_id = 20 }
}

update_demand_for_trade_good_0 = { #birds
	demand_from_province_dev = {
		trade_good_id = 0
		base = 1
		multiplier = 1
	}
}
update_demand_for_trade_good_1 = { #bison
	demand_from_province_dev = {
		trade_good_id = 1
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_2 = { #camels
	demand_from_province_dev = {
		trade_good_id = 2
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_3 = { #copper
	demand_from_province_dev = {
		trade_good_id = 3
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_4 = { #crustaceans
	demand_from_province_dev = {
		trade_good_id = 4
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_5 = { #dates
	demand_from_province_dev = {
		trade_good_id = 5
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_6 = { #fish
	demand_from_province_dev = {
		trade_good_id = 6
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_7 = { #fruit
	demand_from_province_dev = {
		trade_good_id = 7
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_8 = { #fur
	demand_from_province_dev = {
		trade_good_id = 8
		base = 0.3
		multiplier = 0.3
	}
}
#update_demand_for_trade_good_9 = { #gold
#	demand_from_province_dev = {
#		trade_good_id = 9
#		base = 0.3
#		multiplier = 0.3
#	}
#}
update_demand_for_trade_good_10 = { #grain
	demand_from_province_dev = {
		trade_good_id = 10
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_11 = { #hardwood
	demand_from_province_dev = {
		trade_good_id = 11
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_12 = { #herbs
	demand_from_province_dev = {
		trade_good_id = 12
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_13 = { #horses
	demand_from_province_dev = {
		trade_good_id = 13
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_14 = { #incense
	demand_from_province_dev = {
		trade_good_id = 14
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_15 = { #ivory
	demand_from_province_dev = {
		trade_good_id = 15
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_16 = { #livestock
	demand_from_province_dev = {
		trade_good_id = 16
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_17 = { #maize
	demand_from_province_dev = {
		trade_good_id = 17
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_18 = { #millet
	demand_from_province_dev = {
		trade_good_id = 18
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_19 = { #palm
	demand_from_province_dev = {
		trade_good_id = 19
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_20 = { #pelagic_fish
	demand_from_province_dev = {
		trade_good_id = 20
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_21 = { #potatoes
	demand_from_province_dev = {
		trade_good_id = 21
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_22 = { #pottery
	demand_from_province_dev = {
		trade_good_id = 22
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_23 = { #poultry
	demand_from_province_dev = {
		trade_good_id = 23
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_24 = { #rice
	demand_from_province_dev = {
		trade_good_id = 24
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_25 = { #salt
	demand_from_province_dev = {
		trade_good_id = 25
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_26 = { #shoal_fish
	demand_from_province_dev = {
		trade_good_id = 26
		base = 0.3
		multiplier = 0.3
	}
}
#update_demand_for_trade_good_27 = { #silver
#	demand_from_province_dev = {
#		trade_good_id = 27
#		base = 0.3
#		multiplier = 0.3
#	}
#}
update_demand_for_trade_good_28 = { #softwood
	demand_from_province_dev = {
		trade_good_id = 28
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_29 = { #stone
	demand_from_province_dev = {
		trade_good_id = 29
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_30 = { #tin
	demand_from_province_dev = {
		trade_good_id = 30
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_31 = { #tropical_wood
	demand_from_province_dev = {
		trade_good_id = 31
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_32 = { #whales
	demand_from_province_dev = {
		trade_good_id = 32
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_33 = { #wool
	demand_from_province_dev = {
		trade_good_id = 33
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_34 = { #apiculture
	demand_from_province_dev = {
		trade_good_id = 34
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_35 = { #alum
	demand_from_province_dev = {
		trade_good_id = 35
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_36 = { #cloves
	demand_from_province_dev = {
		trade_good_id = 36
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_37 = { #black_pepper
	demand_from_province_dev = {
		trade_good_id = 37
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_38 = { #cocoa
	demand_from_province_dev = {
		trade_good_id = 38
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_39 = { #cassava
	demand_from_province_dev = {
		trade_good_id = 39
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_40 = { #cinnamon
	demand_from_province_dev = {
		trade_good_id = 40
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_41 = { #coffee
	demand_from_province_dev = {
		trade_good_id = 41
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_42 = { #cotton
	demand_from_province_dev = {
		trade_good_id = 42
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_43 = { #dairy
	demand_from_province_dev = {
		trade_good_id = 43
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_44 = { #dyes
	demand_from_province_dev = {
		trade_good_id = 44
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_45 = { #gems
	demand_from_province_dev = {
		trade_good_id = 45
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_46 = { #hemp
	demand_from_province_dev = {
		trade_good_id = 46
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_47 = { #iron
	demand_from_province_dev = {
		trade_good_id = 47
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_48 = { #lead
	demand_from_province_dev = {
		trade_good_id = 48
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_49 = { #leather
	demand_from_province_dev = {
		trade_good_id = 49
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_50 = { #marble
	demand_from_province_dev = {
		trade_good_id = 50
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_51 = { #mollusk
	demand_from_province_dev = {
		trade_good_id = 51
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_52 = { #mercury
	demand_from_province_dev = {
		trade_good_id = 52
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_53 = { #chili_peppers
	demand_from_province_dev = {
		trade_good_id = 53
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_54 = { #nuts
	demand_from_province_dev = {
		trade_good_id = 54
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_55 = { #spices
	demand_from_province_dev = {
		trade_good_id = 55
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_56 = { #olives
	demand_from_province_dev = {
		trade_good_id = 56
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_57 = { #opium
	demand_from_province_dev = {
		trade_good_id = 57
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_58 = { #paper
	demand_from_province_dev = {
		trade_good_id = 58
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_59 = { #niter
	demand_from_province_dev = {
		trade_good_id = 59
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_60 = { #slaves
	demand_from_province_dev = {
		trade_good_id = 60
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_61 = { #saffron
	demand_from_province_dev = {
		trade_good_id = 61
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_62 = { #silk
	demand_from_province_dev = {
		trade_good_id = 62
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_63 = { #legumes
	demand_from_province_dev = {
		trade_good_id = 63
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_64 = { #sugar
	demand_from_province_dev = {
		trade_good_id = 64
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_65 = { #sulfur
	demand_from_province_dev = {
		trade_good_id = 65
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_66 = { #tea
	demand_from_province_dev = {
		trade_good_id = 66
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_67 = { #tobacco
	demand_from_province_dev = {
		trade_good_id = 67
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_68 = { #vanilla
	demand_from_province_dev = {
		trade_good_id = 68
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_69 = { #zinc
	demand_from_province_dev = {
		trade_good_id = 69
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_70 = { #artifices
	demand_from_province_dev = {
		trade_good_id = 70
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_71 = { #beer
	demand_from_province_dev = {
		trade_good_id = 71
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_72 = { #bricks
	demand_from_province_dev = {
		trade_good_id = 72
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_73 = { #books
	demand_from_province_dev = {
		trade_good_id = 73
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_74 = { #brass
	demand_from_province_dev = {
		trade_good_id = 74
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_75 = { #bronze
	demand_from_province_dev = {
		trade_good_id = 75
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_76 = { #cigars
	demand_from_province_dev = {
		trade_good_id = 76
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_77 = { #confectionary
	demand_from_province_dev = {
		trade_good_id = 77
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_78 = { #fertilizer
	demand_from_province_dev = {
		trade_good_id = 78
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_79 = { #furniture
	demand_from_province_dev = {
		trade_good_id = 79
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_80 = { #glass
	demand_from_province_dev = {
		trade_good_id = 80
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_81 = { #gunpowder
	demand_from_province_dev = {
		trade_good_id = 81
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_82 = { #metalwork
	demand_from_province_dev = {
		trade_good_id = 82
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_83 = { #jewelry
	demand_from_province_dev = {
		trade_good_id = 83
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_84 = { #naval_supplies
	demand_from_province_dev = {
		trade_good_id = 84
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_85 = { #chinaware
	demand_from_province_dev = {
		trade_good_id = 85
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_86 = { #resin
	demand_from_province_dev = {
		trade_good_id = 86
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_87 = { #rubber
	demand_from_province_dev = {
		trade_good_id = 87
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_88 = { #rum
	demand_from_province_dev = {
		trade_good_id = 88
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_89 = { #steel
	demand_from_province_dev = {
		trade_good_id = 89
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_90 = { #cloth
	demand_from_province_dev = {
		trade_good_id = 90
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_91 = { #wine
	demand_from_province_dev = {
		trade_good_id = 91
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_92 = { #aluminum
	demand_from_province_dev = {
		trade_good_id = 92
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_93 = { #chemicals
	demand_from_province_dev = {
		trade_good_id = 93
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_94 = { #concrete
	demand_from_province_dev = {
		trade_good_id = 94
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_95 = { #explosives
	demand_from_province_dev = {
		trade_good_id = 95
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_96 = { #machine_parts
	demand_from_province_dev = {
		trade_good_id = 96
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_97 = { #medicine
	demand_from_province_dev = {
		trade_good_id = 97
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_98 = { #perfume
	demand_from_province_dev = {
		trade_good_id = 98
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_99 = { #preserves
	demand_from_province_dev = {
		trade_good_id = 99
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_100 = { #chromite
	demand_from_province_dev = {
		trade_good_id = 100
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_101 = { #coal
	demand_from_province_dev = {
		trade_good_id = 101
		base = 0.3
		multiplier = 0.3
	}
}
update_demand_for_trade_good_102 = { #phosphate
	demand_from_province_dev = {
		trade_good_id = 102
		base = 0.3
		multiplier = 0.3
	}
}
#update_demand_for_trade_good_103 = { #unknown
	
#}