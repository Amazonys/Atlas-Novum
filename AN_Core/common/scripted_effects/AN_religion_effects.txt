AN_check_religion_minorities = {
	hidden_effect = {
		export_to_variable = {
			variable_name = AN_province_religion
			value = religion
		}
		owner = {
			export_to_variable = {
				variable_name = AN_tol_htc
				value = modifier:tolerance_heretic
			}
			export_to_variable = {
				variable_name = AN_tol_hth
				value =  modifier:tolerance_heathen 
			}
		}
		if = {
			limit = { owner = { religion = variable:PREV:AN_minority_religion } }
			if = {
				limit = { check_variable = { which = AN_minority_religion_size value = 3 } }
				remove_province_modifier = AN_true_faith_minority_religion_1
				remove_province_modifier = AN_true_faith_minority_religion_2
				remove_province_modifier = AN_sync_faith_minority_religion_1
				remove_province_modifier = AN_sync_faith_minority_religion_2
				remove_province_modifier = AN_sync_faith_minority_religion_3
				remove_province_modifier = AN_tol_heretic_minority_religion_1
				remove_province_modifier = AN_tol_heretic_minority_religion_2
				remove_province_modifier = AN_tol_heretic_minority_religion_3
				remove_province_modifier = AN_int_heretic_minority_religion_1
				remove_province_modifier = AN_int_heretic_minority_religion_2
				remove_province_modifier = AN_int_heretic_minority_religion_3
				remove_province_modifier = AN_tol_heathen_minority_religion_1
				remove_province_modifier = AN_tol_heathen_minority_religion_2
				remove_province_modifier = AN_tol_heathen_minority_religion_3
				remove_province_modifier = AN_int_heathen_minority_religion_1
				remove_province_modifier = AN_int_heathen_minority_religion_2
				remove_province_modifier = AN_int_heathen_minority_religion_3
				add_permanent_province_modifier = {
					name = AN_true_faith_minority_religion_3
					duration = -1
				}
			}
			else_if = {
				limit = { check_variable = { which = AN_minority_religion_size value = 2 } }
				remove_province_modifier = AN_true_faith_minority_religion_1
				remove_province_modifier = AN_true_faith_minority_religion_3
				remove_province_modifier = AN_sync_faith_minority_religion_1
				remove_province_modifier = AN_sync_faith_minority_religion_2
				remove_province_modifier = AN_sync_faith_minority_religion_3
				remove_province_modifier = AN_tol_heretic_minority_religion_1
				remove_province_modifier = AN_tol_heretic_minority_religion_2
				remove_province_modifier = AN_tol_heretic_minority_religion_3
				remove_province_modifier = AN_int_heretic_minority_religion_1
				remove_province_modifier = AN_int_heretic_minority_religion_2
				remove_province_modifier = AN_int_heretic_minority_religion_3
				remove_province_modifier = AN_tol_heathen_minority_religion_1
				remove_province_modifier = AN_tol_heathen_minority_religion_2
				remove_province_modifier = AN_tol_heathen_minority_religion_3
				remove_province_modifier = AN_int_heathen_minority_religion_1
				remove_province_modifier = AN_int_heathen_minority_religion_2
				remove_province_modifier = AN_int_heathen_minority_religion_3
				add_permanent_province_modifier = {
					name = AN_true_faith_minority_religion_2
					duration = -1
				}
			}
			else_if = {
				limit = { check_variable = { which = AN_minority_religion_size value = 1 } }
				remove_province_modifier = AN_true_faith_minority_religion_2
				remove_province_modifier = AN_true_faith_minority_religion_3
				remove_province_modifier = AN_sync_faith_minority_religion_1
				remove_province_modifier = AN_sync_faith_minority_religion_2
				remove_province_modifier = AN_sync_faith_minority_religion_3
				remove_province_modifier = AN_tol_heretic_minority_religion_1
				remove_province_modifier = AN_tol_heretic_minority_religion_2
				remove_province_modifier = AN_tol_heretic_minority_religion_3
				remove_province_modifier = AN_int_heretic_minority_religion_1
				remove_province_modifier = AN_int_heretic_minority_religion_2
				remove_province_modifier = AN_int_heretic_minority_religion_3
				remove_province_modifier = AN_tol_heathen_minority_religion_1
				remove_province_modifier = AN_tol_heathen_minority_religion_2
				remove_province_modifier = AN_tol_heathen_minority_religion_3
				remove_province_modifier = AN_int_heathen_minority_religion_1
				remove_province_modifier = AN_int_heathen_minority_religion_2
				remove_province_modifier = AN_int_heathen_minority_religion_3
				add_permanent_province_modifier = {
					name = AN_true_faith_minority_religion_1
					duration = -1
				}
			}
		}
		else_if = {
			limit = { owner = { secondary_religion = variable:PREV:AN_minority_religion } }
			if = {
				limit = { check_variable = { which = AN_minority_religion_size value = 3 } }
				remove_province_modifier = AN_true_faith_minority_religion_1
				remove_province_modifier = AN_true_faith_minority_religion_2
				remove_province_modifier = AN_true_faith_minority_religion_3
				remove_province_modifier = AN_sync_faith_minority_religion_1
				remove_province_modifier = AN_sync_faith_minority_religion_2
				remove_province_modifier = AN_tol_heretic_minority_religion_1
				remove_province_modifier = AN_tol_heretic_minority_religion_2
				remove_province_modifier = AN_tol_heretic_minority_religion_3
				remove_province_modifier = AN_int_heretic_minority_religion_1
				remove_province_modifier = AN_int_heretic_minority_religion_2
				remove_province_modifier = AN_int_heretic_minority_religion_3
				remove_province_modifier = AN_tol_heathen_minority_religion_1
				remove_province_modifier = AN_tol_heathen_minority_religion_2
				remove_province_modifier = AN_tol_heathen_minority_religion_3
				remove_province_modifier = AN_int_heathen_minority_religion_1
				remove_province_modifier = AN_int_heathen_minority_religion_2
				remove_province_modifier = AN_int_heathen_minority_religion_3
				add_permanent_province_modifier = {
					name = AN_sync_faith_minority_religion_3
					duration = -1
				}
			}
			else_if = {
				limit = { check_variable = { which = AN_minority_religion_size value = 2 } }
				remove_province_modifier = AN_true_faith_minority_religion_1
				remove_province_modifier = AN_true_faith_minority_religion_2
				remove_province_modifier = AN_true_faith_minority_religion_3
				remove_province_modifier = AN_sync_faith_minority_religion_1
				remove_province_modifier = AN_sync_faith_minority_religion_3
				remove_province_modifier = AN_tol_heretic_minority_religion_1
				remove_province_modifier = AN_tol_heretic_minority_religion_2
				remove_province_modifier = AN_tol_heretic_minority_religion_3
				remove_province_modifier = AN_int_heretic_minority_religion_1
				remove_province_modifier = AN_int_heretic_minority_religion_2
				remove_province_modifier = AN_int_heretic_minority_religion_3
				remove_province_modifier = AN_tol_heathen_minority_religion_1
				remove_province_modifier = AN_tol_heathen_minority_religion_2
				remove_province_modifier = AN_tol_heathen_minority_religion_3
				remove_province_modifier = AN_int_heathen_minority_religion_1
				remove_province_modifier = AN_int_heathen_minority_religion_2
				remove_province_modifier = AN_int_heathen_minority_religion_3
				add_permanent_province_modifier = {
					name = AN_sync_faith_minority_religion_2
					duration = -1
				}
			}
			else_if = {
				limit = { check_variable = { which = AN_minority_religion_size value = 1 } }
				remove_province_modifier = AN_true_faith_minority_religion_1
				remove_province_modifier = AN_true_faith_minority_religion_2
				remove_province_modifier = AN_true_faith_minority_religion_3
				remove_province_modifier = AN_sync_faith_minority_religion_2
				remove_province_modifier = AN_sync_faith_minority_religion_3
				remove_province_modifier = AN_tol_heretic_minority_religion_1
				remove_province_modifier = AN_tol_heretic_minority_religion_2
				remove_province_modifier = AN_tol_heretic_minority_religion_3
				remove_province_modifier = AN_int_heretic_minority_religion_1
				remove_province_modifier = AN_int_heretic_minority_religion_2
				remove_province_modifier = AN_int_heretic_minority_religion_3
				remove_province_modifier = AN_tol_heathen_minority_religion_1
				remove_province_modifier = AN_tol_heathen_minority_religion_2
				remove_province_modifier = AN_tol_heathen_minority_religion_3
				remove_province_modifier = AN_int_heathen_minority_religion_1
				remove_province_modifier = AN_int_heathen_minority_religion_2
				remove_province_modifier = AN_int_heathen_minority_religion_3
				add_permanent_province_modifier = {
					name = AN_sync_faith_minority_religion_1
					duration = -1
				}
			}
		}
		else_if = {
			limit = { owner = { religion_group = variable:PREV:AN_minority_religion } }
			if = { 
				limit = { owner = { check_variable = { which = AN_tol_htc value = 0 } } }
				if = {
					limit = { check_variable = { which = AN_minority_religion_size value = 3 } }
					remove_province_modifier = AN_true_faith_minority_religion_1
					remove_province_modifier = AN_true_faith_minority_religion_2
					remove_province_modifier = AN_true_faith_minority_religion_3
					remove_province_modifier = AN_sync_faith_minority_religion_1
					remove_province_modifier = AN_sync_faith_minority_religion_2
					remove_province_modifier = AN_sync_faith_minority_religion_3
					remove_province_modifier = AN_tol_heretic_minority_religion_1
					remove_province_modifier = AN_tol_heretic_minority_religion_2
					remove_province_modifier = AN_int_heretic_minority_religion_1
					remove_province_modifier = AN_int_heretic_minority_religion_2
					remove_province_modifier = AN_int_heretic_minority_religion_3
					remove_province_modifier = AN_tol_heathen_minority_religion_1
					remove_province_modifier = AN_tol_heathen_minority_religion_2
					remove_province_modifier = AN_tol_heathen_minority_religion_3
					remove_province_modifier = AN_int_heathen_minority_religion_1
					remove_province_modifier = AN_int_heathen_minority_religion_2
					remove_province_modifier = AN_int_heathen_minority_religion_3
					add_permanent_province_modifier = {
						name = AN_tol_heretic_minority_religion_3
						duration = -1
					}
				}
				else_if = {
					limit = { check_variable = { which = AN_minority_religion_size value = 2 } }
					remove_province_modifier = AN_true_faith_minority_religion_1
					remove_province_modifier = AN_true_faith_minority_religion_2
					remove_province_modifier = AN_true_faith_minority_religion_3
					remove_province_modifier = AN_sync_faith_minority_religion_1
					remove_province_modifier = AN_sync_faith_minority_religion_2
					remove_province_modifier = AN_sync_faith_minority_religion_3
					remove_province_modifier = AN_tol_heretic_minority_religion_1
					remove_province_modifier = AN_tol_heretic_minority_religion_3
					remove_province_modifier = AN_int_heretic_minority_religion_1
					remove_province_modifier = AN_int_heretic_minority_religion_2
					remove_province_modifier = AN_int_heretic_minority_religion_3
					remove_province_modifier = AN_tol_heathen_minority_religion_1
					remove_province_modifier = AN_tol_heathen_minority_religion_2
					remove_province_modifier = AN_tol_heathen_minority_religion_3
					remove_province_modifier = AN_int_heathen_minority_religion_1
					remove_province_modifier = AN_int_heathen_minority_religion_2
					remove_province_modifier = AN_int_heathen_minority_religion_3
					add_permanent_province_modifier = {
						name = AN_tol_heretic_minority_religion_2
						duration = -1
					}
				}
				else_if = {
					limit = { check_variable = { which = AN_minority_religion_size value = 1 } }
					remove_province_modifier = AN_true_faith_minority_religion_1
					remove_province_modifier = AN_true_faith_minority_religion_2
					remove_province_modifier = AN_true_faith_minority_religion_3
					remove_province_modifier = AN_sync_faith_minority_religion_1
					remove_province_modifier = AN_sync_faith_minority_religion_2
					remove_province_modifier = AN_sync_faith_minority_religion_3
					remove_province_modifier = AN_tol_heretic_minority_religion_2
					remove_province_modifier = AN_tol_heretic_minority_religion_3
					remove_province_modifier = AN_int_heretic_minority_religion_1
					remove_province_modifier = AN_int_heretic_minority_religion_2
					remove_province_modifier = AN_int_heretic_minority_religion_3
					remove_province_modifier = AN_tol_heathen_minority_religion_1
					remove_province_modifier = AN_tol_heathen_minority_religion_2
					remove_province_modifier = AN_tol_heathen_minority_religion_3
					remove_province_modifier = AN_int_heathen_minority_religion_1
					remove_province_modifier = AN_int_heathen_minority_religion_2
					remove_province_modifier = AN_int_heathen_minority_religion_3
					add_permanent_province_modifier = {
						name = AN_tol_heretic_minority_religion_1
						duration = -1
					}
				}	
			}
			else = { 
				if = {
					limit = { check_variable = { which = AN_minority_religion_size value = 3 } }
					remove_province_modifier = AN_true_faith_minority_religion_1
					remove_province_modifier = AN_true_faith_minority_religion_2
					remove_province_modifier = AN_true_faith_minority_religion_3
					remove_province_modifier = AN_sync_faith_minority_religion_1
					remove_province_modifier = AN_sync_faith_minority_religion_2
					remove_province_modifier = AN_sync_faith_minority_religion_3
					remove_province_modifier = AN_tol_heretic_minority_religion_1
					remove_province_modifier = AN_tol_heretic_minority_religion_2
					remove_province_modifier = AN_tol_heretic_minority_religion_3
					remove_province_modifier = AN_int_heretic_minority_religion_1
					remove_province_modifier = AN_int_heretic_minority_religion_2
					remove_province_modifier = AN_tol_heathen_minority_religion_1
					remove_province_modifier = AN_tol_heathen_minority_religion_2
					remove_province_modifier = AN_tol_heathen_minority_religion_3
					remove_province_modifier = AN_int_heathen_minority_religion_1
					remove_province_modifier = AN_int_heathen_minority_religion_2
					remove_province_modifier = AN_int_heathen_minority_religion_3
					add_permanent_province_modifier = {
						name = AN_int_heretic_minority_religion_3
						duration = -1
					}
				}
				else_if = {
					limit = { check_variable = { which = AN_minority_religion_size value = 2 } }
					remove_province_modifier = AN_true_faith_minority_religion_1
					remove_province_modifier = AN_true_faith_minority_religion_2
					remove_province_modifier = AN_true_faith_minority_religion_3
					remove_province_modifier = AN_sync_faith_minority_religion_1
					remove_province_modifier = AN_sync_faith_minority_religion_2
					remove_province_modifier = AN_sync_faith_minority_religion_3
					remove_province_modifier = AN_tol_heretic_minority_religion_1
					remove_province_modifier = AN_tol_heretic_minority_religion_2
					remove_province_modifier = AN_tol_heretic_minority_religion_3
					remove_province_modifier = AN_int_heretic_minority_religion_1
					remove_province_modifier = AN_int_heretic_minority_religion_3
					remove_province_modifier = AN_tol_heathen_minority_religion_1
					remove_province_modifier = AN_tol_heathen_minority_religion_2
					remove_province_modifier = AN_tol_heathen_minority_religion_3
					remove_province_modifier = AN_int_heathen_minority_religion_1
					remove_province_modifier = AN_int_heathen_minority_religion_2
					remove_province_modifier = AN_int_heathen_minority_religion_3
					add_permanent_province_modifier = {
						name = AN_int_heretic_minority_religion_2
						duration = -1
					}
				}
				else_if = {
					limit = { check_variable = { which = AN_minority_religion_size value = 1 } }
					remove_province_modifier = AN_true_faith_minority_religion_1
					remove_province_modifier = AN_true_faith_minority_religion_2
					remove_province_modifier = AN_true_faith_minority_religion_3
					remove_province_modifier = AN_sync_faith_minority_religion_1
					remove_province_modifier = AN_sync_faith_minority_religion_2
					remove_province_modifier = AN_sync_faith_minority_religion_3
					remove_province_modifier = AN_tol_heretic_minority_religion_1
					remove_province_modifier = AN_tol_heretic_minority_religion_2
					remove_province_modifier = AN_tol_heretic_minority_religion_3
					remove_province_modifier = AN_int_heretic_minority_religion_2
					remove_province_modifier = AN_int_heretic_minority_religion_3
					remove_province_modifier = AN_tol_heathen_minority_religion_1
					remove_province_modifier = AN_tol_heathen_minority_religion_2
					remove_province_modifier = AN_tol_heathen_minority_religion_3
					remove_province_modifier = AN_int_heathen_minority_religion_1
					remove_province_modifier = AN_int_heathen_minority_religion_2
					remove_province_modifier = AN_int_heathen_minority_religion_3
					add_permanent_province_modifier = {
						name = AN_int_heretic_minority_religion_1
						duration = -1
					}
				}
			}
		}
		else_if = {
			limit = { owner = { NOT = { religion_group = variable:PREV:AN_minority_religion } } }
			if = { 
				limit = { owner = { check_variable = { which = AN_tol_hth value = 0 } } } 
				if = {
					limit = { check_variable = { which = AN_minority_religion_size value = 3 } }
					remove_province_modifier = AN_true_faith_minority_religion_1
					remove_province_modifier = AN_true_faith_minority_religion_2
					remove_province_modifier = AN_true_faith_minority_religion_3
					remove_province_modifier = AN_sync_faith_minority_religion_1
					remove_province_modifier = AN_sync_faith_minority_religion_2
					remove_province_modifier = AN_sync_faith_minority_religion_3
					remove_province_modifier = AN_tol_heretic_minority_religion_1
					remove_province_modifier = AN_tol_heretic_minority_religion_2
					remove_province_modifier = AN_tol_heretic_minority_religion_3
					remove_province_modifier = AN_int_heretic_minority_religion_1
					remove_province_modifier = AN_int_heretic_minority_religion_2
					remove_province_modifier = AN_int_heretic_minority_religion_3
					remove_province_modifier = AN_tol_heathen_minority_religion_1
					remove_province_modifier = AN_tol_heathen_minority_religion_2
					remove_province_modifier = AN_int_heathen_minority_religion_1
					remove_province_modifier = AN_int_heathen_minority_religion_2
					remove_province_modifier = AN_int_heathen_minority_religion_3
					add_permanent_province_modifier = {
						name = AN_tol_heathen_minority_religion_3
						duration = -1
					}
				}
				else_if = {
					limit = { check_variable = { which = AN_minority_religion_size value = 2 } }
					remove_province_modifier = AN_true_faith_minority_religion_1
					remove_province_modifier = AN_true_faith_minority_religion_2
					remove_province_modifier = AN_true_faith_minority_religion_3
					remove_province_modifier = AN_sync_faith_minority_religion_1
					remove_province_modifier = AN_sync_faith_minority_religion_2
					remove_province_modifier = AN_sync_faith_minority_religion_3
					remove_province_modifier = AN_tol_heretic_minority_religion_1
					remove_province_modifier = AN_tol_heretic_minority_religion_2
					remove_province_modifier = AN_tol_heretic_minority_religion_3
					remove_province_modifier = AN_int_heretic_minority_religion_1
					remove_province_modifier = AN_int_heretic_minority_religion_2
					remove_province_modifier = AN_int_heretic_minority_religion_3
					remove_province_modifier = AN_tol_heathen_minority_religion_1
					remove_province_modifier = AN_tol_heathen_minority_religion_3
					remove_province_modifier = AN_int_heathen_minority_religion_1
					remove_province_modifier = AN_int_heathen_minority_religion_2
					remove_province_modifier = AN_int_heathen_minority_religion_3
					add_permanent_province_modifier = {
						name = AN_tol_heathen_minority_religion_2
						duration = -1
					}
				}
				else_if = {
					limit = { check_variable = { which = AN_minority_religion_size value = 1 } }
					remove_province_modifier = AN_true_faith_minority_religion_1
					remove_province_modifier = AN_true_faith_minority_religion_2
					remove_province_modifier = AN_true_faith_minority_religion_3
					remove_province_modifier = AN_sync_faith_minority_religion_1
					remove_province_modifier = AN_sync_faith_minority_religion_2
					remove_province_modifier = AN_sync_faith_minority_religion_3
					remove_province_modifier = AN_tol_heretic_minority_religion_1
					remove_province_modifier = AN_tol_heretic_minority_religion_2
					remove_province_modifier = AN_tol_heretic_minority_religion_3
					remove_province_modifier = AN_int_heretic_minority_religion_1
					remove_province_modifier = AN_int_heretic_minority_religion_2
					remove_province_modifier = AN_int_heretic_minority_religion_3
					remove_province_modifier = AN_tol_heathen_minority_religion_2
					remove_province_modifier = AN_tol_heathen_minority_religion_3
					remove_province_modifier = AN_int_heathen_minority_religion_1
					remove_province_modifier = AN_int_heathen_minority_religion_2
					remove_province_modifier = AN_int_heathen_minority_religion_3
					add_permanent_province_modifier = {
						name = AN_tol_heathen_minority_religion_1
						duration = -1
					}
				}	
			}
			else = { 
				if = {
					limit = { check_variable = { which = AN_minority_religion_size value = 3 } }
					remove_province_modifier = AN_true_faith_minority_religion_1
					remove_province_modifier = AN_true_faith_minority_religion_2
					remove_province_modifier = AN_true_faith_minority_religion_3
					remove_province_modifier = AN_sync_faith_minority_religion_1
					remove_province_modifier = AN_sync_faith_minority_religion_2
					remove_province_modifier = AN_sync_faith_minority_religion_3
					remove_province_modifier = AN_tol_heretic_minority_religion_1
					remove_province_modifier = AN_tol_heretic_minority_religion_2
					remove_province_modifier = AN_tol_heretic_minority_religion_3
					remove_province_modifier = AN_int_heretic_minority_religion_1
					remove_province_modifier = AN_int_heretic_minority_religion_2
					remove_province_modifier = AN_int_heretic_minority_religion_3
					remove_province_modifier = AN_tol_heathen_minority_religion_1
					remove_province_modifier = AN_tol_heathen_minority_religion_2
					remove_province_modifier = AN_tol_heathen_minority_religion_3
					remove_province_modifier = AN_int_heathen_minority_religion_1
					remove_province_modifier = AN_int_heathen_minority_religion_2
					add_permanent_province_modifier = {
						name = AN_int_heathen_minority_religion_3
						duration = -1
					}
				}
				else_if = {
					limit = { check_variable = { which = AN_minority_religion_size value = 2 } }
					remove_province_modifier = AN_true_faith_minority_religion_1
					remove_province_modifier = AN_true_faith_minority_religion_2
					remove_province_modifier = AN_true_faith_minority_religion_3
					remove_province_modifier = AN_sync_faith_minority_religion_1
					remove_province_modifier = AN_sync_faith_minority_religion_2
					remove_province_modifier = AN_sync_faith_minority_religion_3
					remove_province_modifier = AN_tol_heretic_minority_religion_1
					remove_province_modifier = AN_tol_heretic_minority_religion_2
					remove_province_modifier = AN_tol_heretic_minority_religion_3
					remove_province_modifier = AN_int_heretic_minority_religion_1
					remove_province_modifier = AN_int_heretic_minority_religion_2
					remove_province_modifier = AN_int_heretic_minority_religion_3
					remove_province_modifier = AN_tol_heathen_minority_religion_1
					remove_province_modifier = AN_tol_heathen_minority_religion_2
					remove_province_modifier = AN_tol_heathen_minority_religion_3
					remove_province_modifier = AN_int_heathen_minority_religion_1
					remove_province_modifier = AN_int_heathen_minority_religion_3
					add_permanent_province_modifier = {
						name = AN_int_heathen_minority_religion_2
						duration = -1
					}
				}
				else_if = {
					limit = { check_variable = { which = AN_minority_religion_size value = 1 } }
					remove_province_modifier = AN_true_faith_minority_religion_1
					remove_province_modifier = AN_true_faith_minority_religion_2
					remove_province_modifier = AN_true_faith_minority_religion_3
					remove_province_modifier = AN_sync_faith_minority_religion_1
					remove_province_modifier = AN_sync_faith_minority_religion_2
					remove_province_modifier = AN_sync_faith_minority_religion_3
					remove_province_modifier = AN_tol_heretic_minority_religion_1
					remove_province_modifier = AN_tol_heretic_minority_religion_2
					remove_province_modifier = AN_tol_heretic_minority_religion_3
					remove_province_modifier = AN_int_heretic_minority_religion_1
					remove_province_modifier = AN_int_heretic_minority_religion_2
					remove_province_modifier = AN_int_heretic_minority_religion_3
					remove_province_modifier = AN_tol_heathen_minority_religion_1
					remove_province_modifier = AN_tol_heathen_minority_religion_2
					remove_province_modifier = AN_tol_heathen_minority_religion_3
					remove_province_modifier = AN_int_heathen_minority_religion_2
					remove_province_modifier = AN_int_heathen_minority_religion_3
					add_permanent_province_modifier = {
						name = AN_int_heathen_minority_religion_1
						duration = -1
					}
				}
			}
		}
		#
		else_if = {
			limit = { 
				OR = {
					NOT = { check_variable = { which = AN_minority_religion_size value = 1 } } 
					is_variable_equal = { which = AN_province_religion which = AN_minority_religion }
				}	
			}
			set_variable = { which = AN_minority_religion value = 0 }
			set_variable = { which = AN_minority_religion_size value = 0 }
			clr_province_flag = AN_expel_min
			remove_province_modifier = AN_true_faith_minority_religion_1
			remove_province_modifier = AN_true_faith_minority_religion_2
			remove_province_modifier = AN_true_faith_minority_religion_3
			remove_province_modifier = AN_sync_faith_minority_religion_1
			remove_province_modifier = AN_sync_faith_minority_religion_2
			remove_province_modifier = AN_sync_faith_minority_religion_3
			remove_province_modifier = AN_tol_heretic_minority_religion_1
			remove_province_modifier = AN_tol_heretic_minority_religion_2
			remove_province_modifier = AN_tol_heretic_minority_religion_3
			remove_province_modifier = AN_int_heretic_minority_religion_1
			remove_province_modifier = AN_int_heretic_minority_religion_2
			remove_province_modifier = AN_int_heretic_minority_religion_3
			remove_province_modifier = AN_tol_heathen_minority_religion_1
			remove_province_modifier = AN_tol_heathen_minority_religion_2
			remove_province_modifier = AN_tol_heathen_minority_religion_3
			remove_province_modifier = AN_int_heathen_minority_religion_1
			remove_province_modifier = AN_int_heathen_minority_religion_2
			remove_province_modifier = AN_int_heathen_minority_religion_3
		}
	}
}

AN_expel_majority_religion = { 
	hidden_effect = {
		12000 = { 
			set_variable = { which = AN_province_religion which = PREV }
			set_variable = { which = AN_minority_religion which = AN_province_religion }
		}
		if = { 
			limit = { has_province_flag = AN_expel_maj }
			owner = {
				every_owned_province = {
					limit = {
						OR = {
							is_variable_equal = { which = AN_province_religion which = event_target:AN_DUMMY_PROV }
							is_variable_equal = { which = AN_minority_religion which = event_target:AN_DUMMY_PROV }
						}
					}
					if = { 
						limit = { is_variable_equal = { which = AN_province_religion which = event_target:AN_DUMMY_PROV } }
						clr_province_flag = AN_expel_maj
					#	set_variable = { which = AN_majority_progress value = 0 }
					}
					else = {
						clr_province_flag = AN_expel_min
					#	set_variable = { which = AN_minority_progress value = 0 }
					}
					AN_check_religion_minorities = yes
				}
			}
		}
		else = {
			owner = {
				every_owned_province = {
					limit = {
						OR = {
							is_variable_equal = { which = AN_province_religion which = event_target:AN_DUMMY_PROV }
							is_variable_equal = { which = AN_minority_religion which = event_target:AN_DUMMY_PROV }
						}
					}
					if = { 
						limit = { is_variable_equal = { which = AN_province_religion which = event_target:AN_DUMMY_PROV } }
						set_province_flag = AN_expel_maj
					#	set_variable = { which = AN_majority_progress value = 0 }
					}
					else = {
						set_province_flag = AN_expel_min
					#	set_variable = { which = AN_minority_progress value = 0 }
					}
					AN_check_religion_minorities = yes
				}
			}
		}
	}
}

AN_expel_minority_religion = { 
	hidden_effect = {
		12000 = { 
			set_variable = { which = AN_minority_religion which = PREV }
			set_variable = { which = AN_province_religion which = AN_minority_religion }
		}
		if = { 
			limit = { has_province_flag = AN_expel_min }
			owner = {
				every_owned_province = {
					limit = {
						OR = {
							is_variable_equal = { which = AN_province_religion which = event_target:AN_DUMMY_PROV }
							is_variable_equal = { which = AN_minority_religion which = event_target:AN_DUMMY_PROV }
						}
					}
					if = { 
						limit = { is_variable_equal = { which = AN_province_religion which = event_target:AN_DUMMY_PROV } }
						clr_province_flag = AN_expel_maj
						#set_variable = { which = AN_majority_progress value = 0 }
					}
					else = {
						clr_province_flag = AN_expel_min
						#set_variable = { which = AN_minority_progress value = 0 }
					}
					AN_check_religion_minorities = yes
				}
			}
		}
		else = {
			owner = {
				every_owned_province = {
					limit = {
						OR = {
							is_variable_equal = { which = AN_province_religion which = event_target:AN_DUMMY_PROV }
							is_variable_equal = { which = AN_minority_religion which = event_target:AN_DUMMY_PROV }
						}
					}
					if = { 
						limit = { is_variable_equal = { which = AN_province_religion which = event_target:AN_DUMMY_PROV } }
						set_province_flag = AN_expel_maj
						#set_variable = { which = AN_majority_progress value = 0 }
					}
					else = {
						set_province_flag = AN_expel_min
						#set_variable = { which = AN_minority_progress value = 0 }
					}
					AN_check_religion_minorities = yes
				}
			}
		}
	}
}

AN_expel_religion = {
	#CHECK FOR ASSOCIATE CULTURES
		
	if = {
		limit = { 
			NOT = { owner = { culture_group = christian } }
			OR = { 
				religion_group = christian 
				minority_religion_group = { RELIGION_GROUP=christian } 
			}
		}
		if = {
			limit = {
				OR = { 
					culture_group = french
					culture_group = occitan
					culture_group = iberian
					culture_group = byzantine_g
					culture_group = armenian_group
				}
				NOT = { culture_group = owner }
				has_owner_accepted_culture = no
			}
			AN_culture_expel_culture = { CULTURE = melkite }
			AN_check_culture_minorities = yes
			AN_check_culture_process = yes
		}
		else_if = {
			limit = {
				OR = {
					minority_culture_group = { CULTURE_GROUP=french } 
					minority_culture_group = { CULTURE_GROUP=occitan } 
					minority_culture_group = { CULTURE_GROUP=iberian } 
					minority_culture_group = { CULTURE_GROUP=byzantine_g } 
					minority_culture_group = { CULTURE_GROUP=armenian_group } 
				}
				NOT = {
					OR = { 
						has_province_modifier = AN_primary_minority_culture_1
						has_province_modifier = AN_primary_minority_culture_2
						has_province_modifier = AN_primary_minority_culture_3
						has_province_modifier = AN_accepted_minority_culture_1
						has_province_modifier = AN_accepted_minority_culture_2
						has_province_modifier = AN_accepted_minority_culture_3
						has_province_modifier = AN_coexisting_minority_culture_1
						has_province_modifier = AN_coexisting_minority_culture_2
						has_province_modifier = AN_coexisting_minority_culture_3
					}
				}
			}
			subtract_variable = { which = AN_minority_culture_size value = 1 }
			AN_check_culture_minorities = yes	
		}
	}
	
	##### MUSLIM CHECKS #####
	if = {
		limit = { 
			NOT = { owner = { culture_group = muslim } }
			OR = { 
				religion_group = muslim 
				minority_religion_group = { RELIGION_GROUP=muslim } 
			}
		}
		if = {
			limit = {
				OR = { 
					culture_group = turko_semitic
					culture_group = turkish_g
					culture_group = berber_group
				}
				NOT = { culture_group = owner }
				has_owner_accepted_culture = no
			}
			AN_culture_expel_culture = { CULTURE = andalucian }
			AN_check_culture_minorities = yes
			AN_check_culture_process = yes
		}
		else_if = {
			limit = {
				OR = {
					minority_culture_group = { CULTURE_GROUP=turko_semitic } 
					minority_culture_group = { CULTURE_GROUP=turkish_g } 
					minority_culture_group = { CULTURE_GROUP=berber_group } 
				}
				NOT = {
					OR = { 
						has_province_modifier = AN_primary_minority_culture_1
						has_province_modifier = AN_primary_minority_culture_2
						has_province_modifier = AN_primary_minority_culture_3
						has_province_modifier = AN_accepted_minority_culture_1
						has_province_modifier = AN_accepted_minority_culture_2
						has_province_modifier = AN_accepted_minority_culture_3
						has_province_modifier = AN_coexisting_minority_culture_1
						has_province_modifier = AN_coexisting_minority_culture_2
						has_province_modifier = AN_coexisting_minority_culture_3
					}
				}
			}
			subtract_variable = { which = AN_minority_culture_size value = 1 }
			AN_check_culture_minorities = yes	
		}
	}
	
	##### JEWISH CHECKS #####
	if = {
		limit = { 
			NOT = { owner = { culture_group = jewish_group } }
			OR = { 
				religion_group = jewish_group 
				minority_religion_group = { RELIGION_GROUP=jewish_group } 
			}
		}
		if = {
			limit = {
				#OR = { 
					culture_group = jewish_culture_group
				#	culture_group = berber_group
				#}
				NOT = { culture_group = owner }
				has_owner_accepted_culture = no
			}
			AN_culture_expel_culture = { CULTURE = palestinian }
			AN_check_culture_minorities = yes
			AN_check_culture_process = yes
		}
		else_if = {
			limit = {
				#OR = {
					minority_culture_group = { CULTURE_GROUP=jewish_culture_group } 
				#	minority_culture_group = { CULTURE_GROUP=berber_group } 
				#}
				NOT = {
					OR = { 
						has_province_modifier = AN_primary_minority_culture_1
						has_province_modifier = AN_primary_minority_culture_2
						has_province_modifier = AN_primary_minority_culture_3
						has_province_modifier = AN_accepted_minority_culture_1
						has_province_modifier = AN_accepted_minority_culture_2
						has_province_modifier = AN_accepted_minority_culture_3
						has_province_modifier = AN_coexisting_minority_culture_1
						has_province_modifier = AN_coexisting_minority_culture_2
						has_province_modifier = AN_coexisting_minority_culture_3
					}
				}
			}
			subtract_variable = { which = AN_minority_culture_size value = 1 }
			AN_check_culture_minorities = yes	
		}
	}
	######################
	######################
	######################
	if = {
		limit = { has_province_flag = AN_expel_maj }
		if = { 
			limit = { check_variable = { which = AN_minority_religion_size value = 3 } }
			change_religion = variable:AN_minority_religion
			set_variable = { which = AN_minority_religion which = AN_province_religion }
			clr_province_flag = AN_expel_maj
			set_province_flag = AN_expel_min
		}
		else_if = { 
			limit = { check_variable = { which = AN_minority_religion_size value = 1 } }
			change_variable = { which = AN_minority_religion_size value = 1 }
		}
		else = {
			owner = { 
				12000 = { 
					change_religion = PREV 
					export_to_variable = {
						variable_name = AN_minority_religion
						value = religion
					}
				} 
			}	
			set_variable = { which = AN_minority_religion which = event_target:AN_DUMMY_PROV } 
			set_variable = { which = AN_minority_religion_size value = 1 } 
		}	
		AN_check_religion_minorities = yes
	}
	else = {
		subtract_variable = { which = AN_minority_religion_size value = 1 }
		AN_check_religion_minorities = yes	
	}
}

AN_culture_expel_culture = {
	12000 = { 
		change_culture = $CULTURE$ 
		export_to_variable = {
			variable_name = AN_minority_culture
			value = culture
		}
	} 
	if = { 
		limit = { is_variable_equal = { which = AN_minority_culture which = event_target:AN_DUMMY_PROV } }
		if = { 
			limit = { check_variable = { which = AN_minority_culture_size value = 3 } }
			change_culture = variable:AN_minority_culture
			set_variable = { which = AN_minority_culture which = AN_province_culture }
		}
		else_if = { 
			limit = { check_variable = { which = AN_culture_culture_size value = 1 } }
			change_variable = { which = AN_minority_culture_size value = 1 }
		}
	}
	else = {
		set_variable = { which = AN_minority_culture which = event_target:AN_DUMMY_PROV } 
		set_variable = { which = AN_minority_culture_size value = 1 } 
	}	
	#AN_check_culture_minorities = yes	
}

AN_culture_expel_effect = {
	owner = {
		12000 = { 
			change_culture = PREV 
			export_to_variable = {
				variable_name = AN_minority_culture
				value = culture
			}
		}
	} 
	if = { 
		limit = { is_variable_equal = { which = AN_minority_culture which = event_target:AN_DUMMY_PROV } }
		if = { 
			limit = { check_variable = { which = AN_minority_culture_size value = 3 } }
			change_culture = variable:AN_minority_culture
			set_variable = { which = AN_minority_culture which = AN_province_culture }
		}
		else_if = { 
			limit = { check_variable = { which = AN_culture_culture_size value = 1 } }
			change_variable = { which = AN_minority_culture_size value = 1 }
		}
	}
	else = {
		set_variable = { which = AN_minority_culture which = event_target:AN_DUMMY_PROV } 
		set_variable = { which = AN_minority_culture_size value = 1 } 
	}	
	#AN_check_culture_minorities = yes	
}



### MINORITY INTERACTIONS


AN_set_minority_religion = {
	custom_tooltip = AN_$RELIGION$_$SIZE$_minority.tooltip
	if = {
		limit = { check_variable = { which = AN_minority_religion_size value = 1 } }
		custom_tooltip = AN_set_minority_religion_replace.tooltip
	}
	hidden_effect = {
		12000 = { 
			change_religion = $RELIGION$ 
			export_to_variable = {
				variable_name = AN_minority_religion
				value = religion
			}
			PREV = { 
				set_variable = { which = AN_minority_religion which = PREV } 
				set_variable = { which = AN_minority_religion_size value = $SIZE$ } 
			}
		}
	}
	AN_check_religion_minorities = yes
}

AN_increase_minority_religion_size = {
	hidden_effect = { change_variable = { which = AN_minority_religion_size value = 1 } }
	if = {
		limit = { check_variable = { which = AN_minority_religion_size value = 4 } }
		change_religion = variable:PREV:AN_minority_religion
		hidden_effect = {
			set_variable = {
				which = AN_minority_religion
				which = AN_province_religion
			}	
			set_variable = { which = AN_minority_religion_size value = 3 }
		}
		custom_tooltip = AN_change_minority_religion_size_swap.tooltip
	}
	else = {
		custom_tooltip = AN_change_minority_religion_size_i.tooltip
	}
	AN_check_religion_minorities = yes
}

AN_decrease_minority_religion_size = {
	custom_tooltip = AN_change_minority_religion_size_d.tooltip
	hidden_effect = { change_variable = { which = AN_minority_religion_size value = -1 } }
	AN_check_religion_minorities = yes
}

AN_remove_minority_religion = {
	custom_tooltip = AN_remove_minority_religion.tooltip
	hidden_effect = { set_variable = { which = AN_minority_religion_size value = 0 } }
	AN_check_religion_minorities = yes
}
