namespace = smm
province_event = {
	id = smm.699
	title = smm_none
	desc = smm_none
	#hidden = yes
	trigger = {
		province_id = 1
		NOT = {
			has_province_flag = smm_timer
		}
	}
	mean_time_to_happen = { days = 1 }
	option = {
		name = smm_none
		set_province_flag = smm_timer
		set_variable = { which = smm_grain_price_store value = 4 }
		every_province = {
			if = {
				limit = {
					tradegoods = grain
				}
				set_province_flag = smm_grain
			}
		}
		owner = {
			country_event = { id = smm.600 }
		}
	}
}
province_event = {
	id = smm.601
	title = smm_none
	desc = smm_none
	#hidden = yes
	trigger = {
		province_id = 1
		had_province_flag = { flag = smm_timer days = 365 }
	}
	option = {
		name = smm_none
		clr_province_flag = smm_timer
		set_province_flag = smm_timer
		owner = {
			country_event = { id = smm.600 }
		}
	}
}
country_event = {
	id = smm.600
	title = smm_none
	desc = smm_none
	#hidden = yes
	is_triggered_only = yes
	immediate = {
		1 = {
			ROOT = { set_variable = { which = smm_grain_price_store which = PREV } }
			#
		}
		set_variable = { which = smm_grain_price which = smm_grain_price_store }
		#
		set_variable = { which = smm_grain_price_store value = 0 }
		#
		
		## evaluate new trade goods
		
		## calculate price changes
		
		## calculate trade good productivity
		every_province = {
			limit = {
				NOT = {
					is_wasteland = yes
				}
			}
			set_variable = { which = smm_tv value = 0 }
			set_variable = { which = smm_tv_disp value = 0 }
			export_to_variable = { which = smm_prod_goods value = modifier:trade_goods_size }
			subtract_variable = { which = smm_prod_goods which = smm_prod_goods_save }
			smm_price_init = { type=grain }
			if = {
				limit = {
					has_province_flag = smm_grain
				}
				#smm_prod_calc
				smm_price_factor = { type=grain }
			}
			
			## assign modifiers
			smm_update_tg_mod = { type=grain }
			#
			set_variable = { which = smm_prod_goods_save which = smm_tv }
			smm_update_value_mod = { value=655.36 }
			smm_update_value_mod = { value=327.68 }
			smm_update_value_mod = { value=163.84 }
			smm_update_value_mod = { value=81.92 }
			smm_update_value_mod = { value=40.96 }
			smm_update_value_mod = { value=20.48 }
			smm_update_value_mod = { value=10.24 }
			smm_update_value_mod = { value=5.12 }
			smm_update_value_mod = { value=2.56 }
			smm_update_value_mod = { value=1.28 }
			smm_update_value_mod = { value=0.64 }
			smm_update_value_mod = { value=0.32 }
			smm_update_value_mod = { value=0.16 }
			smm_update_value_mod = { value=0.08 }
			smm_update_value_mod = { value=0.04 }
			smm_update_value_mod = { value=0.02 }
			smm_update_value_mod = { value=0.01 }
		}
		set_variable = { which = smm_grain_price value = 0 }
		#
	}
	option = {
		name = smm_none
	}
}